Benchmark results for version: chunk
Test run on: 2025年 08月 22日 星期五 14:10:32 CST
----------------------------------------------------

--- Test Parameters: B=1, H=2, T=4096, D=64 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 4096, 64]
Input Shape (g): [B, T, H] = [1, 4096, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 2, 64])
Average Execution Time: 340.34 us
Peak Memory Usage: 6.05 MB
--------------------

--- Test Parameters: B=1, H=2, T=4096, D=96 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 4096, 96]
Input Shape (g): [B, T, H] = [1, 4096, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 2, 96])
Average Execution Time: 368.58 us
Peak Memory Usage: 9.80 MB
--------------------

--- Test Parameters: B=1, H=2, T=4096, D=128 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 4096, 128]
Input Shape (g): [B, T, H] = [1, 4096, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 2, 128])
Average Execution Time: 783.93 us
Peak Memory Usage: 14.05 MB
--------------------

--- Test Parameters: B=1, H=2, T=4096, D=160 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 4096, 160]
Input Shape (g): [B, T, H] = [1, 4096, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 2, 160])
Average Execution Time: 373.20 us
Peak Memory Usage: 18.80 MB
--------------------

--- Test Parameters: B=1, H=2, T=4096, D=192 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 4096, 192]
Input Shape (g): [B, T, H] = [1, 4096, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 2, 192])
Average Execution Time: 551.55 us
Peak Memory Usage: 24.05 MB
--------------------

--- Test Parameters: B=1, H=2, T=4096, D=256 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 4096, 256]
Input Shape (g): [B, T, H] = [1, 4096, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 2, 256])
Average Execution Time: 1337.16 us
Peak Memory Usage: 36.05 MB
--------------------

--- Test Parameters: B=1, H=2, T=8192, D=64 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 8192, 64]
Input Shape (g): [B, T, H] = [1, 8192, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 2, 64])
Average Execution Time: 389.09 us
Peak Memory Usage: 12.09 MB
--------------------

--- Test Parameters: B=1, H=2, T=8192, D=96 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 8192, 96]
Input Shape (g): [B, T, H] = [1, 8192, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 2, 96])
Average Execution Time: 825.24 us
Peak Memory Usage: 20.09 MB
--------------------

--- Test Parameters: B=1, H=2, T=8192, D=128 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 8192, 128]
Input Shape (g): [B, T, H] = [1, 8192, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 2, 128])
Average Execution Time: 702.82 us
Peak Memory Usage: 28.09 MB
--------------------

--- Test Parameters: B=1, H=2, T=8192, D=160 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 8192, 160]
Input Shape (g): [B, T, H] = [1, 8192, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 2, 160])
Average Execution Time: 887.68 us
Peak Memory Usage: 37.59 MB
--------------------

--- Test Parameters: B=1, H=2, T=8192, D=192 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 8192, 192]
Input Shape (g): [B, T, H] = [1, 8192, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 2, 192])
Average Execution Time: 880.76 us
Peak Memory Usage: 48.09 MB
--------------------

--- Test Parameters: B=1, H=2, T=8192, D=256 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 8192, 256]
Input Shape (g): [B, T, H] = [1, 8192, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 2, 256])
Average Execution Time: 497.71 us
Peak Memory Usage: 72.09 MB
--------------------

--- Test Parameters: B=1, H=2, T=16384, D=64 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 16384, 64]
Input Shape (g): [B, T, H] = [1, 16384, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 2, 64])
Average Execution Time: 509.39 us
Peak Memory Usage: 24.19 MB
--------------------

--- Test Parameters: B=1, H=2, T=16384, D=96 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 16384, 96]
Input Shape (g): [B, T, H] = [1, 16384, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 2, 96])
Average Execution Time: 582.93 us
Peak Memory Usage: 39.19 MB
--------------------

--- Test Parameters: B=1, H=2, T=16384, D=128 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 16384, 128]
Input Shape (g): [B, T, H] = [1, 16384, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 2, 128])
Average Execution Time: 717.10 us
Peak Memory Usage: 56.19 MB
--------------------

--- Test Parameters: B=1, H=2, T=16384, D=160 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 16384, 160]
Input Shape (g): [B, T, H] = [1, 16384, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 2, 160])
Average Execution Time: 628.59 us
Peak Memory Usage: 75.19 MB
--------------------

--- Test Parameters: B=1, H=2, T=16384, D=192 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 16384, 192]
Input Shape (g): [B, T, H] = [1, 16384, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 2, 192])
Average Execution Time: 1086.15 us
Peak Memory Usage: 96.19 MB
--------------------

--- Test Parameters: B=1, H=2, T=16384, D=256 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 16384, 256]
Input Shape (g): [B, T, H] = [1, 16384, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 2, 256])
Average Execution Time: 706.65 us
Peak Memory Usage: 144.19 MB
--------------------

--- Test Parameters: B=1, H=2, T=32768, D=64 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 32768, 64]
Input Shape (g): [B, T, H] = [1, 32768, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 2, 64])
Average Execution Time: 1547.74 us
Peak Memory Usage: 48.38 MB
--------------------

--- Test Parameters: B=1, H=2, T=32768, D=96 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 32768, 96]
Input Shape (g): [B, T, H] = [1, 32768, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 2, 96])
Average Execution Time: 1993.96 us
Peak Memory Usage: 78.38 MB
--------------------

--- Test Parameters: B=1, H=2, T=32768, D=128 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 32768, 128]
Input Shape (g): [B, T, H] = [1, 32768, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 2, 128])
Average Execution Time: 1306.26 us
Peak Memory Usage: 112.38 MB
--------------------

--- Test Parameters: B=1, H=2, T=32768, D=160 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 32768, 160]
Input Shape (g): [B, T, H] = [1, 32768, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 2, 160])
Average Execution Time: 1410.54 us
Peak Memory Usage: 150.38 MB
--------------------

--- Test Parameters: B=1, H=2, T=32768, D=192 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 32768, 192]
Input Shape (g): [B, T, H] = [1, 32768, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 2, 192])
Average Execution Time: 1098.04 us
Peak Memory Usage: 192.38 MB
--------------------

--- Test Parameters: B=1, H=2, T=32768, D=256 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 32768, 256]
Input Shape (g): [B, T, H] = [1, 32768, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 2, 256])
Average Execution Time: 1274.65 us
Peak Memory Usage: 288.38 MB
--------------------

--- Test Parameters: B=1, H=2, T=65536, D=64 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 65536, 64]
Input Shape (g): [B, T, H] = [1, 65536, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 2, 64])
Average Execution Time: 1570.94 us
Peak Memory Usage: 96.75 MB
--------------------

--- Test Parameters: B=1, H=2, T=65536, D=96 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 65536, 96]
Input Shape (g): [B, T, H] = [1, 65536, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 2, 96])
Average Execution Time: 1507.28 us
Peak Memory Usage: 156.75 MB
--------------------

--- Test Parameters: B=1, H=2, T=65536, D=128 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 65536, 128]
Input Shape (g): [B, T, H] = [1, 65536, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 2, 128])
Average Execution Time: 1624.43 us
Peak Memory Usage: 224.75 MB
--------------------

--- Test Parameters: B=1, H=2, T=65536, D=160 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 65536, 160]
Input Shape (g): [B, T, H] = [1, 65536, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 2, 160])
Average Execution Time: 1766.22 us
Peak Memory Usage: 300.75 MB
--------------------

--- Test Parameters: B=1, H=2, T=65536, D=192 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 65536, 192]
Input Shape (g): [B, T, H] = [1, 65536, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 2, 192])
Average Execution Time: 4270.55 us
Peak Memory Usage: 384.75 MB
--------------------

--- Test Parameters: B=1, H=2, T=65536, D=256 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 65536, 256]
Input Shape (g): [B, T, H] = [1, 65536, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 2, 256])
Average Execution Time: 1928.47 us
Peak Memory Usage: 576.75 MB
--------------------

--- Test Parameters: B=1, H=2, T=131072, D=64 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 131072, 64]
Input Shape (g): [B, T, H] = [1, 131072, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 2, 64])
Average Execution Time: 2351.15 us
Peak Memory Usage: 193.50 MB
--------------------

--- Test Parameters: B=1, H=2, T=131072, D=96 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 131072, 96]
Input Shape (g): [B, T, H] = [1, 131072, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 2, 96])
Average Execution Time: 2899.82 us
Peak Memory Usage: 313.50 MB
--------------------

--- Test Parameters: B=1, H=2, T=131072, D=128 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 131072, 128]
Input Shape (g): [B, T, H] = [1, 131072, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 2, 128])
Average Execution Time: 2697.95 us
Peak Memory Usage: 449.50 MB
--------------------

--- Test Parameters: B=1, H=2, T=131072, D=160 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 131072, 160]
Input Shape (g): [B, T, H] = [1, 131072, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 2, 160])
Average Execution Time: 3763.08 us
Peak Memory Usage: 601.50 MB
--------------------

--- Test Parameters: B=1, H=2, T=131072, D=192 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 131072, 192]
Input Shape (g): [B, T, H] = [1, 131072, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 2, 192])
Average Execution Time: 3428.95 us
Peak Memory Usage: 769.50 MB
--------------------

--- Test Parameters: B=1, H=2, T=131072, D=256 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 131072, 256]
Input Shape (g): [B, T, H] = [1, 131072, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 2, 256])
Average Execution Time: 5677.18 us
Peak Memory Usage: 1153.50 MB
--------------------

--- Test Parameters: B=1, H=4, T=4096, D=64 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 4096, 64]
Input Shape (g): [B, T, H] = [1, 4096, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 4, 64])
Average Execution Time: 360.72 us
Peak Memory Usage: 12.09 MB
--------------------

--- Test Parameters: B=1, H=4, T=4096, D=96 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 4096, 96]
Input Shape (g): [B, T, H] = [1, 4096, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 4, 96])
Average Execution Time: 354.10 us
Peak Memory Usage: 20.09 MB
--------------------

--- Test Parameters: B=1, H=4, T=4096, D=128 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 4096, 128]
Input Shape (g): [B, T, H] = [1, 4096, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 4, 128])
Average Execution Time: 517.00 us
Peak Memory Usage: 28.09 MB
--------------------

--- Test Parameters: B=1, H=4, T=4096, D=160 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 4096, 160]
Input Shape (g): [B, T, H] = [1, 4096, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 4, 160])
Average Execution Time: 387.13 us
Peak Memory Usage: 37.59 MB
--------------------

--- Test Parameters: B=1, H=4, T=4096, D=192 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 4096, 192]
Input Shape (g): [B, T, H] = [1, 4096, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 4, 192])
Average Execution Time: 420.08 us
Peak Memory Usage: 48.09 MB
--------------------

--- Test Parameters: B=1, H=4, T=4096, D=256 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 4096, 256]
Input Shape (g): [B, T, H] = [1, 4096, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 4, 256])
Average Execution Time: 623.88 us
Peak Memory Usage: 72.09 MB
--------------------

--- Test Parameters: B=1, H=4, T=8192, D=64 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 8192, 64]
Input Shape (g): [B, T, H] = [1, 8192, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 4, 64])
Average Execution Time: 403.55 us
Peak Memory Usage: 24.19 MB
--------------------

--- Test Parameters: B=1, H=4, T=8192, D=96 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 8192, 96]
Input Shape (g): [B, T, H] = [1, 8192, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 4, 96])
Average Execution Time: 507.94 us
Peak Memory Usage: 39.19 MB
--------------------

--- Test Parameters: B=1, H=4, T=8192, D=128 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 8192, 128]
Input Shape (g): [B, T, H] = [1, 8192, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 4, 128])
Average Execution Time: 503.70 us
Peak Memory Usage: 56.19 MB
--------------------

--- Test Parameters: B=1, H=4, T=8192, D=160 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 8192, 160]
Input Shape (g): [B, T, H] = [1, 8192, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 4, 160])
Average Execution Time: 505.34 us
Peak Memory Usage: 75.19 MB
--------------------

--- Test Parameters: B=1, H=4, T=8192, D=192 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 8192, 192]
Input Shape (g): [B, T, H] = [1, 8192, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 4, 192])
Average Execution Time: 546.36 us
Peak Memory Usage: 96.19 MB
--------------------

--- Test Parameters: B=1, H=4, T=8192, D=256 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 8192, 256]
Input Shape (g): [B, T, H] = [1, 8192, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 4, 256])
Average Execution Time: 625.61 us
Peak Memory Usage: 144.19 MB
--------------------

--- Test Parameters: B=1, H=4, T=16384, D=64 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 16384, 64]
Input Shape (g): [B, T, H] = [1, 16384, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 4, 64])
Average Execution Time: 595.96 us
Peak Memory Usage: 48.38 MB
--------------------

--- Test Parameters: B=1, H=4, T=16384, D=96 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 16384, 96]
Input Shape (g): [B, T, H] = [1, 16384, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 4, 96])
Average Execution Time: 627.41 us
Peak Memory Usage: 78.38 MB
--------------------

--- Test Parameters: B=1, H=4, T=16384, D=128 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 16384, 128]
Input Shape (g): [B, T, H] = [1, 16384, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 4, 128])
Average Execution Time: 645.09 us
Peak Memory Usage: 112.38 MB
--------------------

--- Test Parameters: B=1, H=4, T=16384, D=160 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 16384, 160]
Input Shape (g): [B, T, H] = [1, 16384, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 4, 160])
Average Execution Time: 729.36 us
Peak Memory Usage: 150.38 MB
--------------------

--- Test Parameters: B=1, H=4, T=16384, D=192 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 16384, 192]
Input Shape (g): [B, T, H] = [1, 16384, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 4, 192])
Average Execution Time: 1076.14 us
Peak Memory Usage: 192.38 MB
--------------------

--- Test Parameters: B=1, H=4, T=16384, D=256 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 16384, 256]
Input Shape (g): [B, T, H] = [1, 16384, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 4, 256])
Average Execution Time: 1010.84 us
Peak Memory Usage: 288.38 MB
--------------------

--- Test Parameters: B=1, H=4, T=32768, D=64 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 32768, 64]
Input Shape (g): [B, T, H] = [1, 32768, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 4, 64])
Average Execution Time: 875.67 us
Peak Memory Usage: 96.75 MB
--------------------

--- Test Parameters: B=1, H=4, T=32768, D=96 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 32768, 96]
Input Shape (g): [B, T, H] = [1, 32768, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 4, 96])
Average Execution Time: 1470.61 us
Peak Memory Usage: 156.75 MB
--------------------

--- Test Parameters: B=1, H=4, T=32768, D=128 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 32768, 128]
Input Shape (g): [B, T, H] = [1, 32768, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 4, 128])
Average Execution Time: 1168.04 us
Peak Memory Usage: 224.75 MB
--------------------

--- Test Parameters: B=1, H=4, T=32768, D=160 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 32768, 160]
Input Shape (g): [B, T, H] = [1, 32768, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 4, 160])
Average Execution Time: 1853.91 us
Peak Memory Usage: 300.75 MB
--------------------

--- Test Parameters: B=1, H=4, T=32768, D=192 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 32768, 192]
Input Shape (g): [B, T, H] = [1, 32768, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 4, 192])
Average Execution Time: 1260.64 us
Peak Memory Usage: 384.75 MB
--------------------

--- Test Parameters: B=1, H=4, T=32768, D=256 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 32768, 256]
Input Shape (g): [B, T, H] = [1, 32768, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 4, 256])
Average Execution Time: 1518.02 us
Peak Memory Usage: 576.75 MB
--------------------

--- Test Parameters: B=1, H=4, T=65536, D=64 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 65536, 64]
Input Shape (g): [B, T, H] = [1, 65536, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 4, 64])
Average Execution Time: 1467.44 us
Peak Memory Usage: 193.50 MB
--------------------

--- Test Parameters: B=1, H=4, T=65536, D=96 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 65536, 96]
Input Shape (g): [B, T, H] = [1, 65536, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 4, 96])
Average Execution Time: 1717.06 us
Peak Memory Usage: 313.50 MB
--------------------

--- Test Parameters: B=1, H=4, T=65536, D=128 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 65536, 128]
Input Shape (g): [B, T, H] = [1, 65536, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 4, 128])
Average Execution Time: 1711.05 us
Peak Memory Usage: 449.50 MB
--------------------

--- Test Parameters: B=1, H=4, T=65536, D=160 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 65536, 160]
Input Shape (g): [B, T, H] = [1, 65536, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 4, 160])
Average Execution Time: 2998.60 us
Peak Memory Usage: 601.50 MB
--------------------

--- Test Parameters: B=1, H=4, T=65536, D=192 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 65536, 192]
Input Shape (g): [B, T, H] = [1, 65536, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 4, 192])
Average Execution Time: 2735.97 us
Peak Memory Usage: 769.50 MB
--------------------

--- Test Parameters: B=1, H=4, T=65536, D=256 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 65536, 256]
Input Shape (g): [B, T, H] = [1, 65536, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 4, 256])
Average Execution Time: 2620.49 us
Peak Memory Usage: 1153.50 MB
--------------------

--- Test Parameters: B=1, H=4, T=131072, D=64 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 131072, 64]
Input Shape (g): [B, T, H] = [1, 131072, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 4, 64])
Average Execution Time: 4526.40 us
Peak Memory Usage: 387.00 MB
--------------------

--- Test Parameters: B=1, H=4, T=131072, D=96 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 131072, 96]
Input Shape (g): [B, T, H] = [1, 131072, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 4, 96])
Average Execution Time: 2927.54 us
Peak Memory Usage: 627.00 MB
--------------------

--- Test Parameters: B=1, H=4, T=131072, D=128 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 131072, 128]
Input Shape (g): [B, T, H] = [1, 131072, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 4, 128])
Average Execution Time: 3826.75 us
Peak Memory Usage: 899.00 MB
--------------------

--- Test Parameters: B=1, H=4, T=131072, D=160 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 131072, 160]
Input Shape (g): [B, T, H] = [1, 131072, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 4, 160])
Average Execution Time: 3532.43 us
Peak Memory Usage: 1203.00 MB
--------------------

--- Test Parameters: B=1, H=4, T=131072, D=192 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 131072, 192]
Input Shape (g): [B, T, H] = [1, 131072, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 4, 192])
Average Execution Time: 5265.42 us
Peak Memory Usage: 1539.00 MB
--------------------

--- Test Parameters: B=1, H=4, T=131072, D=256 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 131072, 256]
Input Shape (g): [B, T, H] = [1, 131072, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 4, 256])
Average Execution Time: 7590.23 us
Peak Memory Usage: 2307.00 MB
--------------------

--- Test Parameters: B=1, H=8, T=4096, D=64 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 4096, 64]
Input Shape (g): [B, T, H] = [1, 4096, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 8, 64])
Average Execution Time: 401.48 us
Peak Memory Usage: 24.19 MB
--------------------

--- Test Parameters: B=1, H=8, T=4096, D=96 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 4096, 96]
Input Shape (g): [B, T, H] = [1, 4096, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 8, 96])
Average Execution Time: 682.06 us
Peak Memory Usage: 39.19 MB
--------------------

--- Test Parameters: B=1, H=8, T=4096, D=128 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 4096, 128]
Input Shape (g): [B, T, H] = [1, 4096, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 8, 128])
Average Execution Time: 432.60 us
Peak Memory Usage: 56.19 MB
--------------------

--- Test Parameters: B=1, H=8, T=4096, D=160 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 4096, 160]
Input Shape (g): [B, T, H] = [1, 4096, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 8, 160])
Average Execution Time: 457.25 us
Peak Memory Usage: 75.19 MB
--------------------

--- Test Parameters: B=1, H=8, T=4096, D=192 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 4096, 192]
Input Shape (g): [B, T, H] = [1, 4096, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 8, 192])
Average Execution Time: 598.18 us
Peak Memory Usage: 96.19 MB
--------------------

--- Test Parameters: B=1, H=8, T=4096, D=256 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 4096, 256]
Input Shape (g): [B, T, H] = [1, 4096, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 8, 256])
Average Execution Time: 519.48 us
Peak Memory Usage: 144.19 MB
--------------------

--- Test Parameters: B=1, H=8, T=8192, D=64 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 8192, 64]
Input Shape (g): [B, T, H] = [1, 8192, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 8, 64])
Average Execution Time: 475.42 us
Peak Memory Usage: 48.38 MB
--------------------

--- Test Parameters: B=1, H=8, T=8192, D=96 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 8192, 96]
Input Shape (g): [B, T, H] = [1, 8192, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 8, 96])
Average Execution Time: 507.30 us
Peak Memory Usage: 78.38 MB
--------------------

--- Test Parameters: B=1, H=8, T=8192, D=128 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 8192, 128]
Input Shape (g): [B, T, H] = [1, 8192, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 8, 128])
Average Execution Time: 819.03 us
Peak Memory Usage: 112.38 MB
--------------------

--- Test Parameters: B=1, H=8, T=8192, D=160 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 8192, 160]
Input Shape (g): [B, T, H] = [1, 8192, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 8, 160])
Average Execution Time: 1113.14 us
Peak Memory Usage: 150.38 MB
--------------------

--- Test Parameters: B=1, H=8, T=8192, D=192 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 8192, 192]
Input Shape (g): [B, T, H] = [1, 8192, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 8, 192])
Average Execution Time: 1061.39 us
Peak Memory Usage: 192.38 MB
--------------------

--- Test Parameters: B=1, H=8, T=8192, D=256 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 8192, 256]
Input Shape (g): [B, T, H] = [1, 8192, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 8, 256])
Average Execution Time: 764.56 us
Peak Memory Usage: 288.38 MB
--------------------

--- Test Parameters: B=1, H=8, T=16384, D=64 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 16384, 64]
Input Shape (g): [B, T, H] = [1, 16384, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 8, 64])
Average Execution Time: 628.46 us
Peak Memory Usage: 96.75 MB
--------------------

--- Test Parameters: B=1, H=8, T=16384, D=96 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 16384, 96]
Input Shape (g): [B, T, H] = [1, 16384, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 8, 96])
Average Execution Time: 2027.94 us
Peak Memory Usage: 156.75 MB
--------------------

--- Test Parameters: B=1, H=8, T=16384, D=128 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 16384, 128]
Input Shape (g): [B, T, H] = [1, 16384, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 8, 128])
Average Execution Time: 1377.68 us
Peak Memory Usage: 224.75 MB
--------------------

--- Test Parameters: B=1, H=8, T=16384, D=160 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 16384, 160]
Input Shape (g): [B, T, H] = [1, 16384, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 8, 160])
Average Execution Time: 910.04 us
Peak Memory Usage: 300.75 MB
--------------------

--- Test Parameters: B=1, H=8, T=16384, D=192 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 16384, 192]
Input Shape (g): [B, T, H] = [1, 16384, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 8, 192])
Average Execution Time: 1091.58 us
Peak Memory Usage: 384.75 MB
--------------------

--- Test Parameters: B=1, H=8, T=16384, D=256 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 16384, 256]
Input Shape (g): [B, T, H] = [1, 16384, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 8, 256])
Average Execution Time: 1473.45 us
Peak Memory Usage: 576.75 MB
--------------------

--- Test Parameters: B=1, H=8, T=32768, D=64 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 32768, 64]
Input Shape (g): [B, T, H] = [1, 32768, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 8, 64])
Average Execution Time: 1005.85 us
Peak Memory Usage: 193.50 MB
--------------------

--- Test Parameters: B=1, H=8, T=32768, D=96 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 32768, 96]
Input Shape (g): [B, T, H] = [1, 32768, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 8, 96])
Average Execution Time: 1373.71 us
Peak Memory Usage: 313.50 MB
--------------------

--- Test Parameters: B=1, H=8, T=32768, D=128 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 32768, 128]
Input Shape (g): [B, T, H] = [1, 32768, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 8, 128])
Average Execution Time: 1629.73 us
Peak Memory Usage: 449.50 MB
--------------------

--- Test Parameters: B=1, H=8, T=32768, D=160 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 32768, 160]
Input Shape (g): [B, T, H] = [1, 32768, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 8, 160])
Average Execution Time: 1663.00 us
Peak Memory Usage: 601.50 MB
--------------------

--- Test Parameters: B=1, H=8, T=32768, D=192 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 32768, 192]
Input Shape (g): [B, T, H] = [1, 32768, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 8, 192])
Average Execution Time: 2085.89 us
Peak Memory Usage: 769.50 MB
--------------------

--- Test Parameters: B=1, H=8, T=32768, D=256 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 32768, 256]
Input Shape (g): [B, T, H] = [1, 32768, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 8, 256])
Average Execution Time: 4324.91 us
Peak Memory Usage: 1153.50 MB
--------------------

--- Test Parameters: B=1, H=8, T=65536, D=64 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 65536, 64]
Input Shape (g): [B, T, H] = [1, 65536, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 8, 64])
Average Execution Time: 1686.35 us
Peak Memory Usage: 387.00 MB
--------------------

--- Test Parameters: B=1, H=8, T=65536, D=96 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 65536, 96]
Input Shape (g): [B, T, H] = [1, 65536, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 8, 96])
Average Execution Time: 2043.57 us
Peak Memory Usage: 627.00 MB
--------------------

--- Test Parameters: B=1, H=8, T=65536, D=128 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 65536, 128]
Input Shape (g): [B, T, H] = [1, 65536, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 8, 128])
Average Execution Time: 2706.71 us
Peak Memory Usage: 899.00 MB
--------------------

--- Test Parameters: B=1, H=8, T=65536, D=160 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 65536, 160]
Input Shape (g): [B, T, H] = [1, 65536, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 8, 160])
Average Execution Time: 3555.90 us
Peak Memory Usage: 1203.00 MB
--------------------

--- Test Parameters: B=1, H=8, T=65536, D=192 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 65536, 192]
Input Shape (g): [B, T, H] = [1, 65536, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 8, 192])
Average Execution Time: 4006.45 us
Peak Memory Usage: 1539.00 MB
--------------------

--- Test Parameters: B=1, H=8, T=65536, D=256 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 65536, 256]
Input Shape (g): [B, T, H] = [1, 65536, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 8, 256])
Average Execution Time: 3895.76 us
Peak Memory Usage: 2307.00 MB
--------------------

--- Test Parameters: B=1, H=8, T=131072, D=64 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 131072, 64]
Input Shape (g): [B, T, H] = [1, 131072, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 8, 64])
Average Execution Time: 3018.19 us
Peak Memory Usage: 774.00 MB
--------------------

--- Test Parameters: B=1, H=8, T=131072, D=96 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 131072, 96]
Input Shape (g): [B, T, H] = [1, 131072, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 8, 96])
Average Execution Time: 3571.61 us
Peak Memory Usage: 1254.00 MB
--------------------

--- Test Parameters: B=1, H=8, T=131072, D=128 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 131072, 128]
Input Shape (g): [B, T, H] = [1, 131072, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 8, 128])
Average Execution Time: 4448.24 us
Peak Memory Usage: 1798.00 MB
--------------------

--- Test Parameters: B=1, H=8, T=131072, D=160 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 131072, 160]
Input Shape (g): [B, T, H] = [1, 131072, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 8, 160])
Average Execution Time: 5210.36 us
Peak Memory Usage: 2406.00 MB
--------------------

--- Test Parameters: B=1, H=8, T=131072, D=192 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 131072, 192]
Input Shape (g): [B, T, H] = [1, 131072, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 8, 192])
Average Execution Time: 7107.86 us
Peak Memory Usage: 3078.00 MB
--------------------

--- Test Parameters: B=1, H=8, T=131072, D=256 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 131072, 256]
Input Shape (g): [B, T, H] = [1, 131072, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 8, 256])
Average Execution Time: 8010.12 us
Peak Memory Usage: 4614.00 MB
--------------------

--- Test Parameters: B=1, H=12, T=4096, D=64 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 4096, 64]
Input Shape (g): [B, T, H] = [1, 4096, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 12, 64])
Average Execution Time: 373.95 us
Peak Memory Usage: 36.28 MB
--------------------

--- Test Parameters: B=1, H=12, T=4096, D=96 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 4096, 96]
Input Shape (g): [B, T, H] = [1, 4096, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 12, 96])
Average Execution Time: 421.91 us
Peak Memory Usage: 58.78 MB
--------------------

--- Test Parameters: B=1, H=12, T=4096, D=128 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 4096, 128]
Input Shape (g): [B, T, H] = [1, 4096, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 12, 128])
Average Execution Time: 641.44 us
Peak Memory Usage: 84.28 MB
--------------------

--- Test Parameters: B=1, H=12, T=4096, D=160 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 4096, 160]
Input Shape (g): [B, T, H] = [1, 4096, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 12, 160])
Average Execution Time: 482.08 us
Peak Memory Usage: 115.78 MB
--------------------

--- Test Parameters: B=1, H=12, T=4096, D=192 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 4096, 192]
Input Shape (g): [B, T, H] = [1, 4096, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 12, 192])
Average Execution Time: 670.84 us
Peak Memory Usage: 144.28 MB
--------------------

--- Test Parameters: B=1, H=12, T=4096, D=256 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 4096, 256]
Input Shape (g): [B, T, H] = [1, 4096, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 12, 256])
Average Execution Time: 659.60 us
Peak Memory Usage: 216.28 MB
--------------------

--- Test Parameters: B=1, H=12, T=8192, D=64 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 8192, 64]
Input Shape (g): [B, T, H] = [1, 8192, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 12, 64])
Average Execution Time: 483.91 us
Peak Memory Usage: 72.56 MB
--------------------

--- Test Parameters: B=1, H=12, T=8192, D=96 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 8192, 96]
Input Shape (g): [B, T, H] = [1, 8192, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 12, 96])
Average Execution Time: 700.02 us
Peak Memory Usage: 117.56 MB
--------------------

--- Test Parameters: B=1, H=12, T=8192, D=128 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 8192, 128]
Input Shape (g): [B, T, H] = [1, 8192, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 12, 128])
Average Execution Time: 910.08 us
Peak Memory Usage: 168.56 MB
--------------------

--- Test Parameters: B=1, H=12, T=8192, D=160 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 8192, 160]
Input Shape (g): [B, T, H] = [1, 8192, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 12, 160])
Average Execution Time: 702.10 us
Peak Memory Usage: 225.56 MB
--------------------

--- Test Parameters: B=1, H=12, T=8192, D=192 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 8192, 192]
Input Shape (g): [B, T, H] = [1, 8192, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 12, 192])
Average Execution Time: 1724.76 us
Peak Memory Usage: 288.56 MB
--------------------

--- Test Parameters: B=1, H=12, T=8192, D=256 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 8192, 256]
Input Shape (g): [B, T, H] = [1, 8192, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 12, 256])
Average Execution Time: 1109.88 us
Peak Memory Usage: 432.56 MB
--------------------

--- Test Parameters: B=1, H=12, T=16384, D=64 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 16384, 64]
Input Shape (g): [B, T, H] = [1, 16384, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 12, 64])
Average Execution Time: 691.93 us
Peak Memory Usage: 145.12 MB
--------------------

--- Test Parameters: B=1, H=12, T=16384, D=96 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 16384, 96]
Input Shape (g): [B, T, H] = [1, 16384, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 12, 96])
Average Execution Time: 893.39 us
Peak Memory Usage: 235.12 MB
--------------------

--- Test Parameters: B=1, H=12, T=16384, D=128 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 16384, 128]
Input Shape (g): [B, T, H] = [1, 16384, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 12, 128])
Average Execution Time: 1062.41 us
Peak Memory Usage: 337.12 MB
--------------------

--- Test Parameters: B=1, H=12, T=16384, D=160 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 16384, 160]
Input Shape (g): [B, T, H] = [1, 16384, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 12, 160])
Average Execution Time: 1139.42 us
Peak Memory Usage: 451.12 MB
--------------------

--- Test Parameters: B=1, H=12, T=16384, D=192 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 16384, 192]
Input Shape (g): [B, T, H] = [1, 16384, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 12, 192])
Average Execution Time: 2053.00 us
Peak Memory Usage: 577.12 MB
--------------------

--- Test Parameters: B=1, H=12, T=16384, D=256 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 16384, 256]
Input Shape (g): [B, T, H] = [1, 16384, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 12, 256])
Average Execution Time: 1703.02 us
Peak Memory Usage: 865.12 MB
--------------------

--- Test Parameters: B=1, H=12, T=32768, D=64 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 32768, 64]
Input Shape (g): [B, T, H] = [1, 32768, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 12, 64])
Average Execution Time: 1119.59 us
Peak Memory Usage: 290.25 MB
--------------------

--- Test Parameters: B=1, H=12, T=32768, D=96 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 32768, 96]
Input Shape (g): [B, T, H] = [1, 32768, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 12, 96])
Average Execution Time: 1355.63 us
Peak Memory Usage: 470.25 MB
--------------------

--- Test Parameters: B=1, H=12, T=32768, D=128 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 32768, 128]
Input Shape (g): [B, T, H] = [1, 32768, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 12, 128])
Average Execution Time: 1493.00 us
Peak Memory Usage: 674.25 MB
--------------------

--- Test Parameters: B=1, H=12, T=32768, D=160 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 32768, 160]
Input Shape (g): [B, T, H] = [1, 32768, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 12, 160])
Average Execution Time: 2007.42 us
Peak Memory Usage: 902.25 MB
--------------------

--- Test Parameters: B=1, H=12, T=32768, D=192 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 32768, 192]
Input Shape (g): [B, T, H] = [1, 32768, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 12, 192])
Average Execution Time: 2160.86 us
Peak Memory Usage: 1154.25 MB
--------------------

--- Test Parameters: B=1, H=12, T=32768, D=256 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 32768, 256]
Input Shape (g): [B, T, H] = [1, 32768, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 12, 256])
Average Execution Time: 5927.78 us
Peak Memory Usage: 1730.25 MB
--------------------

--- Test Parameters: B=1, H=12, T=65536, D=64 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 65536, 64]
Input Shape (g): [B, T, H] = [1, 65536, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 12, 64])
Average Execution Time: 1857.19 us
Peak Memory Usage: 580.50 MB
--------------------

--- Test Parameters: B=1, H=12, T=65536, D=96 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 65536, 96]
Input Shape (g): [B, T, H] = [1, 65536, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 12, 96])
Average Execution Time: 3503.37 us
Peak Memory Usage: 940.50 MB
--------------------

--- Test Parameters: B=1, H=12, T=65536, D=128 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 65536, 128]
Input Shape (g): [B, T, H] = [1, 65536, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 12, 128])
Average Execution Time: 2797.61 us
Peak Memory Usage: 1348.50 MB
--------------------

--- Test Parameters: B=1, H=12, T=65536, D=160 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 65536, 160]
Input Shape (g): [B, T, H] = [1, 65536, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 12, 160])
Average Execution Time: 4003.13 us
Peak Memory Usage: 1804.50 MB
--------------------

--- Test Parameters: B=1, H=12, T=65536, D=192 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 65536, 192]
Input Shape (g): [B, T, H] = [1, 65536, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 12, 192])
Average Execution Time: 4062.61 us
Peak Memory Usage: 2308.50 MB
--------------------

--- Test Parameters: B=1, H=12, T=65536, D=256 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 65536, 256]
Input Shape (g): [B, T, H] = [1, 65536, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 12, 256])
Average Execution Time: 6493.28 us
Peak Memory Usage: 3460.50 MB
--------------------

--- Test Parameters: B=1, H=12, T=131072, D=64 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 131072, 64]
Input Shape (g): [B, T, H] = [1, 131072, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 12, 64])
Average Execution Time: 6665.20 us
Peak Memory Usage: 1161.00 MB
--------------------

--- Test Parameters: B=1, H=12, T=131072, D=96 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 131072, 96]
Input Shape (g): [B, T, H] = [1, 131072, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 12, 96])
Average Execution Time: 4572.55 us
Peak Memory Usage: 1881.00 MB
--------------------

--- Test Parameters: B=1, H=12, T=131072, D=128 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 131072, 128]
Input Shape (g): [B, T, H] = [1, 131072, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 12, 128])
Average Execution Time: 6065.94 us
Peak Memory Usage: 2697.00 MB
--------------------

--- Test Parameters: B=1, H=12, T=131072, D=160 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 131072, 160]
Input Shape (g): [B, T, H] = [1, 131072, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 12, 160])
Average Execution Time: 8993.40 us
Peak Memory Usage: 3609.00 MB
--------------------

--- Test Parameters: B=1, H=12, T=131072, D=192 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 131072, 192]
Input Shape (g): [B, T, H] = [1, 131072, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 12, 192])
Average Execution Time: 8226.86 us
Peak Memory Usage: 4617.00 MB
--------------------

--- Test Parameters: B=1, H=12, T=131072, D=256 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 131072, 256]
Input Shape (g): [B, T, H] = [1, 131072, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 12, 256])
Average Execution Time: 11726.77 us
Peak Memory Usage: 6921.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=4096, D=64 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 4096, 64]
Input Shape (g): [B, T, H] = [1, 4096, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 16, 64])
Average Execution Time: 571.64 us
Peak Memory Usage: 48.38 MB
--------------------

--- Test Parameters: B=1, H=16, T=4096, D=96 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 4096, 96]
Input Shape (g): [B, T, H] = [1, 4096, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 16, 96])
Average Execution Time: 556.40 us
Peak Memory Usage: 78.38 MB
--------------------

--- Test Parameters: B=1, H=16, T=4096, D=128 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 4096, 128]
Input Shape (g): [B, T, H] = [1, 4096, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 16, 128])
Average Execution Time: 513.99 us
Peak Memory Usage: 112.38 MB
--------------------

--- Test Parameters: B=1, H=16, T=4096, D=160 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 4096, 160]
Input Shape (g): [B, T, H] = [1, 4096, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 16, 160])
Average Execution Time: 650.96 us
Peak Memory Usage: 150.38 MB
--------------------

--- Test Parameters: B=1, H=16, T=4096, D=192 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 4096, 192]
Input Shape (g): [B, T, H] = [1, 4096, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 16, 192])
Average Execution Time: 599.19 us
Peak Memory Usage: 192.38 MB
--------------------

--- Test Parameters: B=1, H=16, T=4096, D=256 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 4096, 256]
Input Shape (g): [B, T, H] = [1, 4096, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 16, 256])
Average Execution Time: 1607.77 us
Peak Memory Usage: 288.38 MB
--------------------

--- Test Parameters: B=1, H=16, T=8192, D=64 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 8192, 64]
Input Shape (g): [B, T, H] = [1, 8192, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 16, 64])
Average Execution Time: 600.93 us
Peak Memory Usage: 96.75 MB
--------------------

--- Test Parameters: B=1, H=16, T=8192, D=96 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 8192, 96]
Input Shape (g): [B, T, H] = [1, 8192, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 16, 96])
Average Execution Time: 602.08 us
Peak Memory Usage: 156.75 MB
--------------------

--- Test Parameters: B=1, H=16, T=8192, D=128 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 8192, 128]
Input Shape (g): [B, T, H] = [1, 8192, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 16, 128])
Average Execution Time: 662.01 us
Peak Memory Usage: 224.75 MB
--------------------

--- Test Parameters: B=1, H=16, T=8192, D=160 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 8192, 160]
Input Shape (g): [B, T, H] = [1, 8192, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 16, 160])
Average Execution Time: 3235.81 us
Peak Memory Usage: 300.75 MB
--------------------

--- Test Parameters: B=1, H=16, T=8192, D=192 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 8192, 192]
Input Shape (g): [B, T, H] = [1, 8192, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 16, 192])
Average Execution Time: 4037.37 us
Peak Memory Usage: 384.75 MB
--------------------

--- Test Parameters: B=1, H=16, T=8192, D=256 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 8192, 256]
Input Shape (g): [B, T, H] = [1, 8192, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 16, 256])
Average Execution Time: 1133.56 us
Peak Memory Usage: 576.75 MB
--------------------

--- Test Parameters: B=1, H=16, T=16384, D=64 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 16384, 64]
Input Shape (g): [B, T, H] = [1, 16384, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 16, 64])
Average Execution Time: 721.87 us
Peak Memory Usage: 193.50 MB
--------------------

--- Test Parameters: B=1, H=16, T=16384, D=96 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 16384, 96]
Input Shape (g): [B, T, H] = [1, 16384, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 16, 96])
Average Execution Time: 932.46 us
Peak Memory Usage: 313.50 MB
--------------------

--- Test Parameters: B=1, H=16, T=16384, D=128 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 16384, 128]
Input Shape (g): [B, T, H] = [1, 16384, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 16, 128])
Average Execution Time: 1264.22 us
Peak Memory Usage: 449.50 MB
--------------------

--- Test Parameters: B=1, H=16, T=16384, D=160 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 16384, 160]
Input Shape (g): [B, T, H] = [1, 16384, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 16, 160])
Average Execution Time: 1269.00 us
Peak Memory Usage: 601.50 MB
--------------------

--- Test Parameters: B=1, H=16, T=16384, D=192 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 16384, 192]
Input Shape (g): [B, T, H] = [1, 16384, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 16, 192])
Average Execution Time: 1573.88 us
Peak Memory Usage: 769.50 MB
--------------------

--- Test Parameters: B=1, H=16, T=16384, D=256 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 16384, 256]
Input Shape (g): [B, T, H] = [1, 16384, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 16, 256])
Average Execution Time: 1944.62 us
Peak Memory Usage: 1153.50 MB
--------------------

--- Test Parameters: B=1, H=16, T=32768, D=64 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 32768, 64]
Input Shape (g): [B, T, H] = [1, 32768, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 16, 64])
Average Execution Time: 1386.74 us
Peak Memory Usage: 387.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=32768, D=96 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 32768, 96]
Input Shape (g): [B, T, H] = [1, 32768, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 16, 96])
Average Execution Time: 1520.19 us
Peak Memory Usage: 627.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=32768, D=128 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 32768, 128]
Input Shape (g): [B, T, H] = [1, 32768, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 16, 128])
Average Execution Time: 1763.51 us
Peak Memory Usage: 899.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=32768, D=160 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 32768, 160]
Input Shape (g): [B, T, H] = [1, 32768, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 16, 160])
Average Execution Time: 3369.29 us
Peak Memory Usage: 1203.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=32768, D=192 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 32768, 192]
Input Shape (g): [B, T, H] = [1, 32768, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 16, 192])
Average Execution Time: 3996.69 us
Peak Memory Usage: 1539.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=32768, D=256 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 32768, 256]
Input Shape (g): [B, T, H] = [1, 32768, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 16, 256])
Average Execution Time: 3859.31 us
Peak Memory Usage: 2307.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=65536, D=64 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 65536, 64]
Input Shape (g): [B, T, H] = [1, 65536, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 16, 64])
Average Execution Time: 2823.68 us
Peak Memory Usage: 774.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=65536, D=96 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 65536, 96]
Input Shape (g): [B, T, H] = [1, 65536, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 16, 96])
Average Execution Time: 3106.83 us
Peak Memory Usage: 1254.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=65536, D=128 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 65536, 128]
Input Shape (g): [B, T, H] = [1, 65536, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 16, 128])
Average Execution Time: 3273.72 us
Peak Memory Usage: 1798.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=65536, D=160 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 65536, 160]
Input Shape (g): [B, T, H] = [1, 65536, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 16, 160])
Average Execution Time: 4618.12 us
Peak Memory Usage: 2406.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=65536, D=192 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 65536, 192]
Input Shape (g): [B, T, H] = [1, 65536, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 16, 192])
Average Execution Time: 5251.37 us
Peak Memory Usage: 3078.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=65536, D=256 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 65536, 256]
Input Shape (g): [B, T, H] = [1, 65536, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 16, 256])
Average Execution Time: 7663.17 us
Peak Memory Usage: 4614.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=131072, D=64 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 131072, 64]
Input Shape (g): [B, T, H] = [1, 131072, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 16, 64])
Average Execution Time: 3786.14 us
Peak Memory Usage: 1548.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=131072, D=96 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 131072, 96]
Input Shape (g): [B, T, H] = [1, 131072, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 16, 96])
Average Execution Time: 5452.32 us
Peak Memory Usage: 2508.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=131072, D=128 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 131072, 128]
Input Shape (g): [B, T, H] = [1, 131072, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 16, 128])
Average Execution Time: 10237.82 us
Peak Memory Usage: 3596.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=131072, D=160 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 131072, 160]
Input Shape (g): [B, T, H] = [1, 131072, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 16, 160])
Average Execution Time: 11211.16 us
Peak Memory Usage: 4812.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=131072, D=192 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 131072, 192]
Input Shape (g): [B, T, H] = [1, 131072, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 16, 192])
Average Execution Time: 10622.62 us
Peak Memory Usage: 6156.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=131072, D=256 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 131072, 256]
Input Shape (g): [B, T, H] = [1, 131072, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 16, 256])
Average Execution Time: 15185.87 us
Peak Memory Usage: 9228.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=4096, D=64 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 4096, 64]
Input Shape (g): [B, T, H] = [1, 4096, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 32, 64])
Average Execution Time: 445.69 us
Peak Memory Usage: 96.75 MB
--------------------

--- Test Parameters: B=1, H=32, T=4096, D=96 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 4096, 96]
Input Shape (g): [B, T, H] = [1, 4096, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 32, 96])
Average Execution Time: 1089.24 us
Peak Memory Usage: 156.75 MB
--------------------

--- Test Parameters: B=1, H=32, T=4096, D=128 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 4096, 128]
Input Shape (g): [B, T, H] = [1, 4096, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 32, 128])
Average Execution Time: 596.27 us
Peak Memory Usage: 224.75 MB
--------------------

--- Test Parameters: B=1, H=32, T=4096, D=160 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 4096, 160]
Input Shape (g): [B, T, H] = [1, 4096, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 32, 160])
Average Execution Time: 832.79 us
Peak Memory Usage: 300.75 MB
--------------------

--- Test Parameters: B=1, H=32, T=4096, D=192 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 4096, 192]
Input Shape (g): [B, T, H] = [1, 4096, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 32, 192])
Average Execution Time: 1075.68 us
Peak Memory Usage: 384.75 MB
--------------------

--- Test Parameters: B=1, H=32, T=4096, D=256 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 4096, 256]
Input Shape (g): [B, T, H] = [1, 4096, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 32, 256])
Average Execution Time: 1208.96 us
Peak Memory Usage: 576.75 MB
--------------------

--- Test Parameters: B=1, H=32, T=8192, D=64 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 8192, 64]
Input Shape (g): [B, T, H] = [1, 8192, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 32, 64])
Average Execution Time: 741.17 us
Peak Memory Usage: 193.50 MB
--------------------

--- Test Parameters: B=1, H=32, T=8192, D=96 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 8192, 96]
Input Shape (g): [B, T, H] = [1, 8192, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 32, 96])
Average Execution Time: 1850.59 us
Peak Memory Usage: 313.50 MB
--------------------

--- Test Parameters: B=1, H=32, T=8192, D=128 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 8192, 128]
Input Shape (g): [B, T, H] = [1, 8192, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 32, 128])
Average Execution Time: 1028.03 us
Peak Memory Usage: 449.50 MB
--------------------

--- Test Parameters: B=1, H=32, T=8192, D=160 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 8192, 160]
Input Shape (g): [B, T, H] = [1, 8192, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 32, 160])
Average Execution Time: 1810.03 us
Peak Memory Usage: 601.50 MB
--------------------

--- Test Parameters: B=1, H=32, T=8192, D=192 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 8192, 192]
Input Shape (g): [B, T, H] = [1, 8192, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 32, 192])
Average Execution Time: 1419.48 us
Peak Memory Usage: 769.50 MB
--------------------

--- Test Parameters: B=1, H=32, T=8192, D=256 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 8192, 256]
Input Shape (g): [B, T, H] = [1, 8192, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 32, 256])
Average Execution Time: 2172.36 us
Peak Memory Usage: 1153.50 MB
--------------------

--- Test Parameters: B=1, H=32, T=16384, D=64 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 16384, 64]
Input Shape (g): [B, T, H] = [1, 16384, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 32, 64])
Average Execution Time: 971.92 us
Peak Memory Usage: 387.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=16384, D=96 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 16384, 96]
Input Shape (g): [B, T, H] = [1, 16384, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 32, 96])
Average Execution Time: 1290.39 us
Peak Memory Usage: 627.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=16384, D=128 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 16384, 128]
Input Shape (g): [B, T, H] = [1, 16384, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 32, 128])
Average Execution Time: 3420.59 us
Peak Memory Usage: 899.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=16384, D=160 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 16384, 160]
Input Shape (g): [B, T, H] = [1, 16384, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 32, 160])
Average Execution Time: 2293.64 us
Peak Memory Usage: 1203.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=16384, D=192 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 16384, 192]
Input Shape (g): [B, T, H] = [1, 16384, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 32, 192])
Average Execution Time: 5529.28 us
Peak Memory Usage: 1539.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=16384, D=256 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 16384, 256]
Input Shape (g): [B, T, H] = [1, 16384, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 32, 256])
Average Execution Time: 3685.45 us
Peak Memory Usage: 2307.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=32768, D=64 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 32768, 64]
Input Shape (g): [B, T, H] = [1, 32768, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 32, 64])
Average Execution Time: 2122.77 us
Peak Memory Usage: 774.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=32768, D=96 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 32768, 96]
Input Shape (g): [B, T, H] = [1, 32768, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 32, 96])
Average Execution Time: 2441.15 us
Peak Memory Usage: 1254.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=32768, D=128 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 32768, 128]
Input Shape (g): [B, T, H] = [1, 32768, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 32, 128])
Average Execution Time: 5636.36 us
Peak Memory Usage: 1798.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=32768, D=160 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 32768, 160]
Input Shape (g): [B, T, H] = [1, 32768, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 32, 160])
Average Execution Time: 4417.98 us
Peak Memory Usage: 2406.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=32768, D=192 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 32768, 192]
Input Shape (g): [B, T, H] = [1, 32768, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 32, 192])
Average Execution Time: 5083.59 us
Peak Memory Usage: 3078.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=32768, D=256 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 32768, 256]
Input Shape (g): [B, T, H] = [1, 32768, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 32, 256])
Average Execution Time: 7857.54 us
Peak Memory Usage: 4614.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=65536, D=64 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 65536, 64]
Input Shape (g): [B, T, H] = [1, 65536, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 32, 64])
Average Execution Time: 2948.33 us
Peak Memory Usage: 1548.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=65536, D=96 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 65536, 96]
Input Shape (g): [B, T, H] = [1, 65536, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 32, 96])
Average Execution Time: 6630.69 us
Peak Memory Usage: 2508.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=65536, D=128 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 65536, 128]
Input Shape (g): [B, T, H] = [1, 65536, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 32, 128])
Average Execution Time: 9766.72 us
Peak Memory Usage: 3596.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=65536, D=160 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 65536, 160]
Input Shape (g): [B, T, H] = [1, 65536, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 32, 160])
Average Execution Time: 9380.92 us
Peak Memory Usage: 4812.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=65536, D=192 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 65536, 192]
Input Shape (g): [B, T, H] = [1, 65536, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 32, 192])
Average Execution Time: 14084.86 us
Peak Memory Usage: 6156.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=65536, D=256 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 65536, 256]
Input Shape (g): [B, T, H] = [1, 65536, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 32, 256])
Average Execution Time: 17550.33 us
Peak Memory Usage: 9228.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=131072, D=64 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 131072, 64]
Input Shape (g): [B, T, H] = [1, 131072, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 32, 64])
Average Execution Time: 6104.51 us
Peak Memory Usage: 3096.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=131072, D=96 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 131072, 96]
Input Shape (g): [B, T, H] = [1, 131072, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 32, 96])
Average Execution Time: 10493.60 us
Peak Memory Usage: 5016.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=131072, D=128 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 131072, 128]
Input Shape (g): [B, T, H] = [1, 131072, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 32, 128])
Average Execution Time: 11133.13 us
Peak Memory Usage: 7192.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=131072, D=160 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 131072, 160]
Input Shape (g): [B, T, H] = [1, 131072, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 32, 160])
Average Execution Time: 18951.42 us
Peak Memory Usage: 9624.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=131072, D=192 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 131072, 192]
Input Shape (g): [B, T, H] = [1, 131072, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 32, 192])
Average Execution Time: 20857.74 us
Peak Memory Usage: 12312.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=131072, D=256 ---
---- Configuration ----
Version to Test: chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 131072, 256]
Input Shape (g): [B, T, H] = [1, 131072, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 32, 256])
Average Execution Time: 31390.81 us
Peak Memory Usage: 18456.00 MB
--------------------
