Benchmark results for version: parallel
Test run on: 2025年 08月 22日 星期五 16:19:04 CST
----------------------------------------------------

--- Test Parameters: B=1, H=2, T=4096, D=64 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 4096, 64]
Input Shape (g): [B, T, H] = [1, 4096, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 2, 64])
Average Execution Time: 238.18 us
Peak Memory Usage: 6.05 MB
--------------------

--- Test Parameters: B=1, H=2, T=4096, D=96 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 4096, 96]
Input Shape (g): [B, T, H] = [1, 4096, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 2, 96])
Average Execution Time: 329.26 us
Peak Memory Usage: 9.05 MB
--------------------

--- Test Parameters: B=1, H=2, T=4096, D=128 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 4096, 128]
Input Shape (g): [B, T, H] = [1, 4096, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 2, 128])
Average Execution Time: 347.82 us
Peak Memory Usage: 12.05 MB
--------------------

--- Test Parameters: B=1, H=2, T=4096, D=160 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 4096, 160]
Input Shape (g): [B, T, H] = [1, 4096, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 2, 160])
Average Execution Time: 573.10 us
Peak Memory Usage: 25.05 MB
--------------------

--- Test Parameters: B=1, H=2, T=4096, D=192 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 4096, 192]
Input Shape (g): [B, T, H] = [1, 4096, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 2, 192])
Average Execution Time: 659.79 us
Peak Memory Usage: 30.05 MB
--------------------

--- Test Parameters: B=1, H=2, T=4096, D=256 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 4096, 256]
Input Shape (g): [B, T, H] = [1, 4096, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 2, 256])
Average Execution Time: 583.64 us
Peak Memory Usage: 40.05 MB
--------------------

--- Test Parameters: B=1, H=2, T=8192, D=64 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 8192, 64]
Input Shape (g): [B, T, H] = [1, 8192, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 2, 64])
Average Execution Time: 531.86 us
Peak Memory Usage: 12.09 MB
--------------------

--- Test Parameters: B=1, H=2, T=8192, D=96 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 8192, 96]
Input Shape (g): [B, T, H] = [1, 8192, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 2, 96])
Average Execution Time: 739.74 us
Peak Memory Usage: 18.09 MB
--------------------

--- Test Parameters: B=1, H=2, T=8192, D=128 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 8192, 128]
Input Shape (g): [B, T, H] = [1, 8192, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 2, 128])
Average Execution Time: 798.80 us
Peak Memory Usage: 24.09 MB
--------------------

--- Test Parameters: B=1, H=2, T=8192, D=160 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 8192, 160]
Input Shape (g): [B, T, H] = [1, 8192, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 2, 160])
Average Execution Time: 1826.29 us
Peak Memory Usage: 50.09 MB
--------------------

--- Test Parameters: B=1, H=2, T=8192, D=192 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 8192, 192]
Input Shape (g): [B, T, H] = [1, 8192, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 2, 192])
Average Execution Time: 1724.68 us
Peak Memory Usage: 60.09 MB
--------------------

--- Test Parameters: B=1, H=2, T=8192, D=256 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 8192, 256]
Input Shape (g): [B, T, H] = [1, 8192, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 2, 256])
Average Execution Time: 1720.10 us
Peak Memory Usage: 80.09 MB
--------------------

--- Test Parameters: B=1, H=2, T=16384, D=64 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 16384, 64]
Input Shape (g): [B, T, H] = [1, 16384, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 2, 64])
Average Execution Time: 1305.85 us
Peak Memory Usage: 24.19 MB
--------------------

--- Test Parameters: B=1, H=2, T=16384, D=96 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 16384, 96]
Input Shape (g): [B, T, H] = [1, 16384, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 2, 96])
Average Execution Time: 2197.92 us
Peak Memory Usage: 36.19 MB
--------------------

--- Test Parameters: B=1, H=2, T=16384, D=128 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 16384, 128]
Input Shape (g): [B, T, H] = [1, 16384, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 2, 128])
Average Execution Time: 2225.14 us
Peak Memory Usage: 48.19 MB
--------------------

--- Test Parameters: B=1, H=2, T=16384, D=160 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 16384, 160]
Input Shape (g): [B, T, H] = [1, 16384, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 2, 160])
Average Execution Time: 5489.89 us
Peak Memory Usage: 100.19 MB
--------------------

--- Test Parameters: B=1, H=2, T=16384, D=192 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 16384, 192]
Input Shape (g): [B, T, H] = [1, 16384, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 2, 192])
Average Execution Time: 5501.01 us
Peak Memory Usage: 120.19 MB
--------------------

--- Test Parameters: B=1, H=2, T=16384, D=256 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 16384, 256]
Input Shape (g): [B, T, H] = [1, 16384, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 2, 256])
Average Execution Time: 5586.04 us
Peak Memory Usage: 160.19 MB
--------------------

--- Test Parameters: B=1, H=2, T=32768, D=64 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 32768, 64]
Input Shape (g): [B, T, H] = [1, 32768, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 2, 64])
Average Execution Time: 4043.85 us
Peak Memory Usage: 48.38 MB
--------------------

--- Test Parameters: B=1, H=2, T=32768, D=96 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 32768, 96]
Input Shape (g): [B, T, H] = [1, 32768, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 2, 96])
Average Execution Time: 6314.58 us
Peak Memory Usage: 72.38 MB
--------------------

--- Test Parameters: B=1, H=2, T=32768, D=128 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 32768, 128]
Input Shape (g): [B, T, H] = [1, 32768, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 2, 128])
Average Execution Time: 6732.83 us
Peak Memory Usage: 96.38 MB
--------------------

--- Test Parameters: B=1, H=2, T=32768, D=160 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 32768, 160]
Input Shape (g): [B, T, H] = [1, 32768, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 2, 160])
Average Execution Time: 19972.36 us
Peak Memory Usage: 200.38 MB
--------------------

--- Test Parameters: B=1, H=2, T=32768, D=192 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 32768, 192]
Input Shape (g): [B, T, H] = [1, 32768, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 2, 192])
Average Execution Time: 20226.38 us
Peak Memory Usage: 240.38 MB
--------------------

--- Test Parameters: B=1, H=2, T=32768, D=256 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 32768, 256]
Input Shape (g): [B, T, H] = [1, 32768, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 2, 256])
Average Execution Time: 21130.65 us
Peak Memory Usage: 320.38 MB
--------------------

--- Test Parameters: B=1, H=2, T=65536, D=64 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 65536, 64]
Input Shape (g): [B, T, H] = [1, 65536, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 2, 64])
Average Execution Time: 13519.22 us
Peak Memory Usage: 96.75 MB
--------------------

--- Test Parameters: B=1, H=2, T=65536, D=96 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 65536, 96]
Input Shape (g): [B, T, H] = [1, 65536, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 2, 96])
Average Execution Time: 21581.70 us
Peak Memory Usage: 144.75 MB
--------------------

--- Test Parameters: B=1, H=2, T=65536, D=128 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 65536, 128]
Input Shape (g): [B, T, H] = [1, 65536, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 2, 128])
Average Execution Time: 23109.43 us
Peak Memory Usage: 192.75 MB
--------------------

--- Test Parameters: B=1, H=2, T=65536, D=160 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 65536, 160]
Input Shape (g): [B, T, H] = [1, 65536, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 2, 160])
Average Execution Time: 79659.42 us
Peak Memory Usage: 400.75 MB
--------------------

--- Test Parameters: B=1, H=2, T=65536, D=192 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 65536, 192]
Input Shape (g): [B, T, H] = [1, 65536, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 2, 192])
Average Execution Time: 80979.26 us
Peak Memory Usage: 480.75 MB
--------------------

--- Test Parameters: B=1, H=2, T=65536, D=256 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 65536, 256]
Input Shape (g): [B, T, H] = [1, 65536, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 2, 256])
Average Execution Time: 84180.04 us
Peak Memory Usage: 640.75 MB
--------------------

--- Test Parameters: B=1, H=2, T=131072, D=64 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 131072, 64]
Input Shape (g): [B, T, H] = [1, 131072, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 2, 64])
Average Execution Time: 51312.84 us
Peak Memory Usage: 193.50 MB
--------------------

--- Test Parameters: B=1, H=2, T=131072, D=96 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 131072, 96]
Input Shape (g): [B, T, H] = [1, 131072, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 2, 96])
Average Execution Time: 83261.26 us
Peak Memory Usage: 289.50 MB
--------------------

--- Test Parameters: B=1, H=2, T=131072, D=128 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 131072, 128]
Input Shape (g): [B, T, H] = [1, 131072, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 2, 128])
Average Execution Time: 88696.09 us
Peak Memory Usage: 385.50 MB
--------------------

--- Test Parameters: B=1, H=2, T=131072, D=160 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 131072, 160]
Input Shape (g): [B, T, H] = [1, 131072, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 2, 160])
Average Execution Time: 322917.12 us
Peak Memory Usage: 801.50 MB
--------------------

--- Test Parameters: B=1, H=2, T=131072, D=192 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 131072, 192]
Input Shape (g): [B, T, H] = [1, 131072, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 2, 192])
Average Execution Time: 327339.60 us
Peak Memory Usage: 961.50 MB
--------------------

--- Test Parameters: B=1, H=2, T=131072, D=256 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 131072, 256]
Input Shape (g): [B, T, H] = [1, 131072, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 2, 256])
Average Execution Time: 336121.77 us
Peak Memory Usage: 1281.50 MB
--------------------

--- Test Parameters: B=1, H=4, T=4096, D=64 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 4096, 64]
Input Shape (g): [B, T, H] = [1, 4096, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 4, 64])
Average Execution Time: 271.27 us
Peak Memory Usage: 12.09 MB
--------------------

--- Test Parameters: B=1, H=4, T=4096, D=96 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 4096, 96]
Input Shape (g): [B, T, H] = [1, 4096, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 4, 96])
Average Execution Time: 381.92 us
Peak Memory Usage: 18.09 MB
--------------------

--- Test Parameters: B=1, H=4, T=4096, D=128 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 4096, 128]
Input Shape (g): [B, T, H] = [1, 4096, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 4, 128])
Average Execution Time: 832.04 us
Peak Memory Usage: 24.09 MB
--------------------

--- Test Parameters: B=1, H=4, T=4096, D=160 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 4096, 160]
Input Shape (g): [B, T, H] = [1, 4096, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 4, 160])
Average Execution Time: 921.74 us
Peak Memory Usage: 50.09 MB
--------------------

--- Test Parameters: B=1, H=4, T=4096, D=192 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 4096, 192]
Input Shape (g): [B, T, H] = [1, 4096, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 4, 192])
Average Execution Time: 925.75 us
Peak Memory Usage: 60.09 MB
--------------------

--- Test Parameters: B=1, H=4, T=4096, D=256 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 4096, 256]
Input Shape (g): [B, T, H] = [1, 4096, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 4, 256])
Average Execution Time: 931.04 us
Peak Memory Usage: 80.09 MB
--------------------

--- Test Parameters: B=1, H=4, T=8192, D=64 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 8192, 64]
Input Shape (g): [B, T, H] = [1, 8192, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 4, 64])
Average Execution Time: 670.46 us
Peak Memory Usage: 24.19 MB
--------------------

--- Test Parameters: B=1, H=4, T=8192, D=96 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 8192, 96]
Input Shape (g): [B, T, H] = [1, 8192, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 4, 96])
Average Execution Time: 1081.21 us
Peak Memory Usage: 36.19 MB
--------------------

--- Test Parameters: B=1, H=4, T=8192, D=128 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 8192, 128]
Input Shape (g): [B, T, H] = [1, 8192, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 4, 128])
Average Execution Time: 1296.87 us
Peak Memory Usage: 48.19 MB
--------------------

--- Test Parameters: B=1, H=4, T=8192, D=160 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 8192, 160]
Input Shape (g): [B, T, H] = [1, 8192, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 4, 160])
Average Execution Time: 2897.61 us
Peak Memory Usage: 100.19 MB
--------------------

--- Test Parameters: B=1, H=4, T=8192, D=192 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 8192, 192]
Input Shape (g): [B, T, H] = [1, 8192, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 4, 192])
Average Execution Time: 2918.74 us
Peak Memory Usage: 120.19 MB
--------------------

--- Test Parameters: B=1, H=4, T=8192, D=256 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 8192, 256]
Input Shape (g): [B, T, H] = [1, 8192, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 4, 256])
Average Execution Time: 2904.90 us
Peak Memory Usage: 160.19 MB
--------------------

--- Test Parameters: B=1, H=4, T=16384, D=64 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 16384, 64]
Input Shape (g): [B, T, H] = [1, 16384, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 4, 64])
Average Execution Time: 2123.84 us
Peak Memory Usage: 48.38 MB
--------------------

--- Test Parameters: B=1, H=4, T=16384, D=96 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 16384, 96]
Input Shape (g): [B, T, H] = [1, 16384, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 4, 96])
Average Execution Time: 3438.48 us
Peak Memory Usage: 72.38 MB
--------------------

--- Test Parameters: B=1, H=4, T=16384, D=128 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 16384, 128]
Input Shape (g): [B, T, H] = [1, 16384, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 4, 128])
Average Execution Time: 3468.16 us
Peak Memory Usage: 96.38 MB
--------------------

--- Test Parameters: B=1, H=4, T=16384, D=160 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 16384, 160]
Input Shape (g): [B, T, H] = [1, 16384, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 4, 160])
Average Execution Time: 10078.30 us
Peak Memory Usage: 200.38 MB
--------------------

--- Test Parameters: B=1, H=4, T=16384, D=192 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 16384, 192]
Input Shape (g): [B, T, H] = [1, 16384, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 4, 192])
Average Execution Time: 10180.35 us
Peak Memory Usage: 240.38 MB
--------------------

--- Test Parameters: B=1, H=4, T=16384, D=256 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 16384, 256]
Input Shape (g): [B, T, H] = [1, 16384, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 4, 256])
Average Execution Time: 10356.99 us
Peak Memory Usage: 320.38 MB
--------------------

--- Test Parameters: B=1, H=4, T=32768, D=64 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 32768, 64]
Input Shape (g): [B, T, H] = [1, 32768, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 4, 64])
Average Execution Time: 6873.94 us
Peak Memory Usage: 96.75 MB
--------------------

--- Test Parameters: B=1, H=4, T=32768, D=96 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 32768, 96]
Input Shape (g): [B, T, H] = [1, 32768, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 4, 96])
Average Execution Time: 11342.10 us
Peak Memory Usage: 144.75 MB
--------------------

--- Test Parameters: B=1, H=4, T=32768, D=128 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 32768, 128]
Input Shape (g): [B, T, H] = [1, 32768, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 4, 128])
Average Execution Time: 11566.39 us
Peak Memory Usage: 192.75 MB
--------------------

--- Test Parameters: B=1, H=4, T=32768, D=160 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 32768, 160]
Input Shape (g): [B, T, H] = [1, 32768, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 4, 160])
Average Execution Time: 38967.08 us
Peak Memory Usage: 400.75 MB
--------------------

--- Test Parameters: B=1, H=4, T=32768, D=192 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 32768, 192]
Input Shape (g): [B, T, H] = [1, 32768, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 4, 192])
Average Execution Time: 39630.63 us
Peak Memory Usage: 480.75 MB
--------------------

--- Test Parameters: B=1, H=4, T=32768, D=256 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 32768, 256]
Input Shape (g): [B, T, H] = [1, 32768, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 4, 256])
Average Execution Time: 40803.21 us
Peak Memory Usage: 640.75 MB
--------------------

--- Test Parameters: B=1, H=4, T=65536, D=64 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 65536, 64]
Input Shape (g): [B, T, H] = [1, 65536, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 4, 64])
Average Execution Time: 25673.17 us
Peak Memory Usage: 193.50 MB
--------------------

--- Test Parameters: B=1, H=4, T=65536, D=96 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 65536, 96]
Input Shape (g): [B, T, H] = [1, 65536, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 4, 96])
Average Execution Time: 42506.94 us
Peak Memory Usage: 289.50 MB
--------------------

--- Test Parameters: B=1, H=4, T=65536, D=128 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 65536, 128]
Input Shape (g): [B, T, H] = [1, 65536, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 4, 128])
Average Execution Time: 43489.79 us
Peak Memory Usage: 385.50 MB
--------------------

--- Test Parameters: B=1, H=4, T=65536, D=160 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 65536, 160]
Input Shape (g): [B, T, H] = [1, 65536, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 4, 160])
Average Execution Time: 158816.35 us
Peak Memory Usage: 801.50 MB
--------------------

--- Test Parameters: B=1, H=4, T=65536, D=192 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 65536, 192]
Input Shape (g): [B, T, H] = [1, 65536, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 4, 192])
Average Execution Time: 161936.80 us
Peak Memory Usage: 961.50 MB
--------------------

--- Test Parameters: B=1, H=4, T=65536, D=256 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 65536, 256]
Input Shape (g): [B, T, H] = [1, 65536, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 4, 256])
Average Execution Time: 166036.30 us
Peak Memory Usage: 1281.50 MB
--------------------

--- Test Parameters: B=1, H=4, T=131072, D=64 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 131072, 64]
Input Shape (g): [B, T, H] = [1, 131072, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 4, 64])
Average Execution Time: 101233.74 us
Peak Memory Usage: 387.00 MB
--------------------

--- Test Parameters: B=1, H=4, T=131072, D=96 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 131072, 96]
Input Shape (g): [B, T, H] = [1, 131072, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 4, 96])
Average Execution Time: 168373.13 us
Peak Memory Usage: 579.00 MB
--------------------

--- Test Parameters: B=1, H=4, T=131072, D=128 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 131072, 128]
Input Shape (g): [B, T, H] = [1, 131072, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 4, 128])
Average Execution Time: 171922.42 us
Peak Memory Usage: 771.00 MB
--------------------

--- Test Parameters: B=1, H=4, T=131072, D=160 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 131072, 160]
Input Shape (g): [B, T, H] = [1, 131072, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 4, 160])
Average Execution Time: 644932.76 us
Peak Memory Usage: 1603.00 MB
--------------------

--- Test Parameters: B=1, H=4, T=131072, D=192 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 131072, 192]
Input Shape (g): [B, T, H] = [1, 131072, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 4, 192])
Average Execution Time: 654075.70 us
Peak Memory Usage: 1923.00 MB
--------------------

--- Test Parameters: B=1, H=4, T=131072, D=256 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 131072, 256]
Input Shape (g): [B, T, H] = [1, 131072, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 4, 256])
Average Execution Time: 670974.65 us
Peak Memory Usage: 2563.00 MB
--------------------

--- Test Parameters: B=1, H=8, T=4096, D=64 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 4096, 64]
Input Shape (g): [B, T, H] = [1, 4096, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 8, 64])
Average Execution Time: 433.71 us
Peak Memory Usage: 24.19 MB
--------------------

--- Test Parameters: B=1, H=8, T=4096, D=96 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 4096, 96]
Input Shape (g): [B, T, H] = [1, 4096, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 8, 96])
Average Execution Time: 620.50 us
Peak Memory Usage: 36.19 MB
--------------------

--- Test Parameters: B=1, H=8, T=4096, D=128 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 4096, 128]
Input Shape (g): [B, T, H] = [1, 4096, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 8, 128])
Average Execution Time: 573.85 us
Peak Memory Usage: 48.19 MB
--------------------

--- Test Parameters: B=1, H=8, T=4096, D=160 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 4096, 160]
Input Shape (g): [B, T, H] = [1, 4096, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 8, 160])
Average Execution Time: 1540.05 us
Peak Memory Usage: 100.19 MB
--------------------

--- Test Parameters: B=1, H=8, T=4096, D=192 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 4096, 192]
Input Shape (g): [B, T, H] = [1, 4096, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 8, 192])
Average Execution Time: 1732.47 us
Peak Memory Usage: 120.19 MB
--------------------

--- Test Parameters: B=1, H=8, T=4096, D=256 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 4096, 256]
Input Shape (g): [B, T, H] = [1, 4096, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 8, 256])
Average Execution Time: 2065.66 us
Peak Memory Usage: 160.19 MB
--------------------

--- Test Parameters: B=1, H=8, T=8192, D=64 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 8192, 64]
Input Shape (g): [B, T, H] = [1, 8192, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 8, 64])
Average Execution Time: 1087.84 us
Peak Memory Usage: 48.38 MB
--------------------

--- Test Parameters: B=1, H=8, T=8192, D=96 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 8192, 96]
Input Shape (g): [B, T, H] = [1, 8192, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 8, 96])
Average Execution Time: 1746.70 us
Peak Memory Usage: 72.38 MB
--------------------

--- Test Parameters: B=1, H=8, T=8192, D=128 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 8192, 128]
Input Shape (g): [B, T, H] = [1, 8192, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 8, 128])
Average Execution Time: 1759.22 us
Peak Memory Usage: 96.38 MB
--------------------

--- Test Parameters: B=1, H=8, T=8192, D=160 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 8192, 160]
Input Shape (g): [B, T, H] = [1, 8192, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 8, 160])
Average Execution Time: 5249.43 us
Peak Memory Usage: 200.38 MB
--------------------

--- Test Parameters: B=1, H=8, T=8192, D=192 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 8192, 192]
Input Shape (g): [B, T, H] = [1, 8192, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 8, 192])
Average Execution Time: 5322.97 us
Peak Memory Usage: 240.38 MB
--------------------

--- Test Parameters: B=1, H=8, T=8192, D=256 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 8192, 256]
Input Shape (g): [B, T, H] = [1, 8192, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 8, 256])
Average Execution Time: 5457.38 us
Peak Memory Usage: 320.38 MB
--------------------

--- Test Parameters: B=1, H=8, T=16384, D=64 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 16384, 64]
Input Shape (g): [B, T, H] = [1, 16384, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 8, 64])
Average Execution Time: 3499.65 us
Peak Memory Usage: 96.75 MB
--------------------

--- Test Parameters: B=1, H=8, T=16384, D=96 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 16384, 96]
Input Shape (g): [B, T, H] = [1, 16384, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 8, 96])
Average Execution Time: 5680.48 us
Peak Memory Usage: 144.75 MB
--------------------

--- Test Parameters: B=1, H=8, T=16384, D=128 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 16384, 128]
Input Shape (g): [B, T, H] = [1, 16384, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 8, 128])
Average Execution Time: 5759.09 us
Peak Memory Usage: 192.75 MB
--------------------

--- Test Parameters: B=1, H=8, T=16384, D=160 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 16384, 160]
Input Shape (g): [B, T, H] = [1, 16384, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 8, 160])
Average Execution Time: 19416.93 us
Peak Memory Usage: 400.75 MB
--------------------

--- Test Parameters: B=1, H=8, T=16384, D=192 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 16384, 192]
Input Shape (g): [B, T, H] = [1, 16384, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 8, 192])
Average Execution Time: 19884.02 us
Peak Memory Usage: 480.75 MB
--------------------

--- Test Parameters: B=1, H=8, T=16384, D=256 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 16384, 256]
Input Shape (g): [B, T, H] = [1, 16384, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 8, 256])
Average Execution Time: 20330.87 us
Peak Memory Usage: 640.75 MB
--------------------

--- Test Parameters: B=1, H=8, T=32768, D=64 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 32768, 64]
Input Shape (g): [B, T, H] = [1, 32768, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 8, 64])
Average Execution Time: 12912.81 us
Peak Memory Usage: 193.50 MB
--------------------

--- Test Parameters: B=1, H=8, T=32768, D=96 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 32768, 96]
Input Shape (g): [B, T, H] = [1, 32768, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 8, 96])
Average Execution Time: 21311.61 us
Peak Memory Usage: 289.50 MB
--------------------

--- Test Parameters: B=1, H=8, T=32768, D=128 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 32768, 128]
Input Shape (g): [B, T, H] = [1, 32768, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 8, 128])
Average Execution Time: 21482.36 us
Peak Memory Usage: 385.50 MB
--------------------

--- Test Parameters: B=1, H=8, T=32768, D=160 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 32768, 160]
Input Shape (g): [B, T, H] = [1, 32768, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 8, 160])
Average Execution Time: 77807.03 us
Peak Memory Usage: 801.50 MB
--------------------

--- Test Parameters: B=1, H=8, T=32768, D=192 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 32768, 192]
Input Shape (g): [B, T, H] = [1, 32768, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 8, 192])
Average Execution Time: 79022.34 us
Peak Memory Usage: 961.50 MB
--------------------

--- Test Parameters: B=1, H=8, T=32768, D=256 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 32768, 256]
Input Shape (g): [B, T, H] = [1, 32768, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 8, 256])
Average Execution Time: 81129.36 us
Peak Memory Usage: 1281.50 MB
--------------------

--- Test Parameters: B=1, H=8, T=65536, D=64 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 65536, 64]
Input Shape (g): [B, T, H] = [1, 65536, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 8, 64])
Average Execution Time: 50420.35 us
Peak Memory Usage: 387.00 MB
--------------------

--- Test Parameters: B=1, H=8, T=65536, D=96 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 65536, 96]
Input Shape (g): [B, T, H] = [1, 65536, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 8, 96])
Average Execution Time: 83250.87 us
Peak Memory Usage: 579.00 MB
--------------------

--- Test Parameters: B=1, H=8, T=65536, D=128 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 65536, 128]
Input Shape (g): [B, T, H] = [1, 65536, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 8, 128])
Average Execution Time: 84442.92 us
Peak Memory Usage: 771.00 MB
--------------------

--- Test Parameters: B=1, H=8, T=65536, D=160 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 65536, 160]
Input Shape (g): [B, T, H] = [1, 65536, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 8, 160])
Average Execution Time: 319848.78 us
Peak Memory Usage: 1603.00 MB
--------------------

--- Test Parameters: B=1, H=8, T=65536, D=192 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 65536, 192]
Input Shape (g): [B, T, H] = [1, 65536, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 8, 192])
Average Execution Time: 323524.31 us
Peak Memory Usage: 1923.00 MB
--------------------

--- Test Parameters: B=1, H=8, T=65536, D=256 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 65536, 256]
Input Shape (g): [B, T, H] = [1, 65536, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 8, 256])
Average Execution Time: 331979.05 us
Peak Memory Usage: 2563.00 MB
--------------------

--- Test Parameters: B=1, H=8, T=131072, D=64 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 131072, 64]
Input Shape (g): [B, T, H] = [1, 131072, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 8, 64])
Average Execution Time: 203715.33 us
Peak Memory Usage: 774.00 MB
--------------------

--- Test Parameters: B=1, H=8, T=131072, D=96 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 131072, 96]
Input Shape (g): [B, T, H] = [1, 131072, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 8, 96])
Average Execution Time: 333409.93 us
Peak Memory Usage: 1158.00 MB
--------------------

--- Test Parameters: B=1, H=8, T=131072, D=128 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 131072, 128]
Input Shape (g): [B, T, H] = [1, 131072, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 8, 128])
Average Execution Time: 340247.43 us
Peak Memory Usage: 1542.00 MB
--------------------

--- Test Parameters: B=1, H=8, T=131072, D=160 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 131072, 160]
Input Shape (g): [B, T, H] = [1, 131072, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 8, 160])
Average Execution Time: 1291618.03 us
Peak Memory Usage: 3206.00 MB
--------------------

--- Test Parameters: B=1, H=8, T=131072, D=192 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 131072, 192]
Input Shape (g): [B, T, H] = [1, 131072, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 8, 192])
Average Execution Time: 1313293.63 us
Peak Memory Usage: 3846.00 MB
--------------------

--- Test Parameters: B=1, H=8, T=131072, D=256 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 131072, 256]
Input Shape (g): [B, T, H] = [1, 131072, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 8, 256])
Average Execution Time: 1352471.45 us
Peak Memory Usage: 5126.00 MB
--------------------

--- Test Parameters: B=1, H=12, T=4096, D=64 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 4096, 64]
Input Shape (g): [B, T, H] = [1, 4096, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 12, 64])
Average Execution Time: 488.33 us
Peak Memory Usage: 36.28 MB
--------------------

--- Test Parameters: B=1, H=12, T=4096, D=96 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 4096, 96]
Input Shape (g): [B, T, H] = [1, 4096, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 12, 96])
Average Execution Time: 756.61 us
Peak Memory Usage: 54.28 MB
--------------------

--- Test Parameters: B=1, H=12, T=4096, D=128 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 4096, 128]
Input Shape (g): [B, T, H] = [1, 4096, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 12, 128])
Average Execution Time: 772.13 us
Peak Memory Usage: 72.28 MB
--------------------

--- Test Parameters: B=1, H=12, T=4096, D=160 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 4096, 160]
Input Shape (g): [B, T, H] = [1, 4096, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 12, 160])
Average Execution Time: 2167.91 us
Peak Memory Usage: 153.28 MB
--------------------

--- Test Parameters: B=1, H=12, T=4096, D=192 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 4096, 192]
Input Shape (g): [B, T, H] = [1, 4096, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 12, 192])
Average Execution Time: 2208.95 us
Peak Memory Usage: 180.28 MB
--------------------

--- Test Parameters: B=1, H=12, T=4096, D=256 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 4096, 256]
Input Shape (g): [B, T, H] = [1, 4096, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 12, 256])
Average Execution Time: 2302.17 us
Peak Memory Usage: 240.28 MB
--------------------

--- Test Parameters: B=1, H=12, T=8192, D=64 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 8192, 64]
Input Shape (g): [B, T, H] = [1, 8192, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 12, 64])
Average Execution Time: 1456.92 us
Peak Memory Usage: 72.56 MB
--------------------

--- Test Parameters: B=1, H=12, T=8192, D=96 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 8192, 96]
Input Shape (g): [B, T, H] = [1, 8192, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 12, 96])
Average Execution Time: 2340.05 us
Peak Memory Usage: 108.56 MB
--------------------

--- Test Parameters: B=1, H=12, T=8192, D=128 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 8192, 128]
Input Shape (g): [B, T, H] = [1, 8192, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 12, 128])
Average Execution Time: 2381.13 us
Peak Memory Usage: 144.56 MB
--------------------

--- Test Parameters: B=1, H=12, T=8192, D=160 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 8192, 160]
Input Shape (g): [B, T, H] = [1, 8192, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 12, 160])
Average Execution Time: 7774.01 us
Peak Memory Usage: 300.56 MB
--------------------

--- Test Parameters: B=1, H=12, T=8192, D=192 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 8192, 192]
Input Shape (g): [B, T, H] = [1, 8192, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 12, 192])
Average Execution Time: 7776.69 us
Peak Memory Usage: 360.56 MB
--------------------

--- Test Parameters: B=1, H=12, T=8192, D=256 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 8192, 256]
Input Shape (g): [B, T, H] = [1, 8192, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 12, 256])
Average Execution Time: 8080.12 us
Peak Memory Usage: 480.56 MB
--------------------

--- Test Parameters: B=1, H=12, T=16384, D=64 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 16384, 64]
Input Shape (g): [B, T, H] = [1, 16384, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 12, 64])
Average Execution Time: 5074.31 us
Peak Memory Usage: 145.12 MB
--------------------

--- Test Parameters: B=1, H=12, T=16384, D=96 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 16384, 96]
Input Shape (g): [B, T, H] = [1, 16384, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 12, 96])
Average Execution Time: 8252.92 us
Peak Memory Usage: 217.12 MB
--------------------

--- Test Parameters: B=1, H=12, T=16384, D=128 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 16384, 128]
Input Shape (g): [B, T, H] = [1, 16384, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 12, 128])
Average Execution Time: 8487.07 us
Peak Memory Usage: 289.12 MB
--------------------

--- Test Parameters: B=1, H=12, T=16384, D=160 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 16384, 160]
Input Shape (g): [B, T, H] = [1, 16384, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 12, 160])
Average Execution Time: 29092.84 us
Peak Memory Usage: 601.12 MB
--------------------

--- Test Parameters: B=1, H=12, T=16384, D=192 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 16384, 192]
Input Shape (g): [B, T, H] = [1, 16384, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 12, 192])
Average Execution Time: 29552.63 us
Peak Memory Usage: 721.12 MB
--------------------

--- Test Parameters: B=1, H=12, T=16384, D=256 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 16384, 256]
Input Shape (g): [B, T, H] = [1, 16384, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 12, 256])
Average Execution Time: 30909.56 us
Peak Memory Usage: 961.12 MB
--------------------

--- Test Parameters: B=1, H=12, T=32768, D=64 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 32768, 64]
Input Shape (g): [B, T, H] = [1, 32768, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 12, 64])
Average Execution Time: 19040.12 us
Peak Memory Usage: 290.25 MB
--------------------

--- Test Parameters: B=1, H=12, T=32768, D=96 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 32768, 96]
Input Shape (g): [B, T, H] = [1, 32768, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 12, 96])
Average Execution Time: 31261.43 us
Peak Memory Usage: 434.25 MB
--------------------

--- Test Parameters: B=1, H=12, T=32768, D=128 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 32768, 128]
Input Shape (g): [B, T, H] = [1, 32768, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 12, 128])
Average Execution Time: 32361.84 us
Peak Memory Usage: 578.25 MB
--------------------

--- Test Parameters: B=1, H=12, T=32768, D=160 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 32768, 160]
Input Shape (g): [B, T, H] = [1, 32768, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 12, 160])
Average Execution Time: 116528.82 us
Peak Memory Usage: 1202.25 MB
--------------------

--- Test Parameters: B=1, H=12, T=32768, D=192 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 32768, 192]
Input Shape (g): [B, T, H] = [1, 32768, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 12, 192])
Average Execution Time: 118498.07 us
Peak Memory Usage: 1442.25 MB
--------------------

--- Test Parameters: B=1, H=12, T=32768, D=256 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 32768, 256]
Input Shape (g): [B, T, H] = [1, 32768, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 12, 256])
Average Execution Time: 124421.04 us
Peak Memory Usage: 1922.25 MB
--------------------

--- Test Parameters: B=1, H=12, T=65536, D=64 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 65536, 64]
Input Shape (g): [B, T, H] = [1, 65536, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 12, 64])
Average Execution Time: 75871.03 us
Peak Memory Usage: 580.50 MB
--------------------

--- Test Parameters: B=1, H=12, T=65536, D=96 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 65536, 96]
Input Shape (g): [B, T, H] = [1, 65536, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 12, 96])
Average Execution Time: 124473.13 us
Peak Memory Usage: 868.50 MB
--------------------

--- Test Parameters: B=1, H=12, T=65536, D=128 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 65536, 128]
Input Shape (g): [B, T, H] = [1, 65536, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 12, 128])
Average Execution Time: 128623.46 us
Peak Memory Usage: 1156.50 MB
--------------------

--- Test Parameters: B=1, H=12, T=65536, D=160 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 65536, 160]
Input Shape (g): [B, T, H] = [1, 65536, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 12, 160])
Average Execution Time: 477846.44 us
Peak Memory Usage: 2404.50 MB
--------------------

--- Test Parameters: B=1, H=12, T=65536, D=192 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 65536, 192]
Input Shape (g): [B, T, H] = [1, 65536, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 12, 192])
Average Execution Time: 484348.27 us
Peak Memory Usage: 2884.50 MB
--------------------

--- Test Parameters: B=1, H=12, T=65536, D=256 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 65536, 256]
Input Shape (g): [B, T, H] = [1, 65536, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 12, 256])
Average Execution Time: 506179.08 us
Peak Memory Usage: 3844.50 MB
--------------------

--- Test Parameters: B=1, H=12, T=131072, D=64 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 131072, 64]
Input Shape (g): [B, T, H] = [1, 131072, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 12, 64])
Average Execution Time: 305108.06 us
Peak Memory Usage: 1161.00 MB
--------------------

--- Test Parameters: B=1, H=12, T=131072, D=96 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 131072, 96]
Input Shape (g): [B, T, H] = [1, 131072, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 12, 96])
Average Execution Time: 499681.90 us
Peak Memory Usage: 1737.00 MB
--------------------

--- Test Parameters: B=1, H=12, T=131072, D=128 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 131072, 128]
Input Shape (g): [B, T, H] = [1, 131072, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 12, 128])
Average Execution Time: 517198.13 us
Peak Memory Usage: 2313.00 MB
--------------------

--- Test Parameters: B=1, H=12, T=131072, D=160 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 131072, 160]
Input Shape (g): [B, T, H] = [1, 131072, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 12, 160])
Average Execution Time: 1933767.97 us
Peak Memory Usage: 4809.00 MB
--------------------

--- Test Parameters: B=1, H=12, T=131072, D=192 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 131072, 192]
Input Shape (g): [B, T, H] = [1, 131072, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 12, 192])
Average Execution Time: 1962144.50 us
Peak Memory Usage: 5769.00 MB
--------------------

--- Test Parameters: B=1, H=12, T=131072, D=256 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 131072, 256]
Input Shape (g): [B, T, H] = [1, 131072, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 12, 256])
Average Execution Time: 2051807.21 us
Peak Memory Usage: 7689.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=4096, D=64 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 4096, 64]
Input Shape (g): [B, T, H] = [1, 4096, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 16, 64])
Average Execution Time: 581.28 us
Peak Memory Usage: 48.38 MB
--------------------

--- Test Parameters: B=1, H=16, T=4096, D=96 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 4096, 96]
Input Shape (g): [B, T, H] = [1, 4096, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 16, 96])
Average Execution Time: 917.58 us
Peak Memory Usage: 72.38 MB
--------------------

--- Test Parameters: B=1, H=16, T=4096, D=128 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 4096, 128]
Input Shape (g): [B, T, H] = [1, 4096, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 16, 128])
Average Execution Time: 913.74 us
Peak Memory Usage: 96.38 MB
--------------------

--- Test Parameters: B=1, H=16, T=4096, D=160 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 4096, 160]
Input Shape (g): [B, T, H] = [1, 4096, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 16, 160])
Average Execution Time: 3029.66 us
Peak Memory Usage: 200.38 MB
--------------------

--- Test Parameters: B=1, H=16, T=4096, D=192 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 4096, 192]
Input Shape (g): [B, T, H] = [1, 4096, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 16, 192])
Average Execution Time: 2867.62 us
Peak Memory Usage: 240.38 MB
--------------------

--- Test Parameters: B=1, H=16, T=4096, D=256 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 4096, 256]
Input Shape (g): [B, T, H] = [1, 4096, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 16, 256])
Average Execution Time: 2948.83 us
Peak Memory Usage: 320.38 MB
--------------------

--- Test Parameters: B=1, H=16, T=8192, D=64 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 8192, 64]
Input Shape (g): [B, T, H] = [1, 8192, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 16, 64])
Average Execution Time: 2082.98 us
Peak Memory Usage: 96.75 MB
--------------------

--- Test Parameters: B=1, H=16, T=8192, D=96 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 8192, 96]
Input Shape (g): [B, T, H] = [1, 8192, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 16, 96])
Average Execution Time: 3037.29 us
Peak Memory Usage: 144.75 MB
--------------------

--- Test Parameters: B=1, H=16, T=8192, D=128 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 8192, 128]
Input Shape (g): [B, T, H] = [1, 8192, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 16, 128])
Average Execution Time: 2970.02 us
Peak Memory Usage: 192.75 MB
--------------------

--- Test Parameters: B=1, H=16, T=8192, D=160 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 8192, 160]
Input Shape (g): [B, T, H] = [1, 8192, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 16, 160])
Average Execution Time: 10080.42 us
Peak Memory Usage: 400.75 MB
--------------------

--- Test Parameters: B=1, H=16, T=8192, D=192 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 8192, 192]
Input Shape (g): [B, T, H] = [1, 8192, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 16, 192])
Average Execution Time: 10264.30 us
Peak Memory Usage: 480.75 MB
--------------------

--- Test Parameters: B=1, H=16, T=8192, D=256 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 8192, 256]
Input Shape (g): [B, T, H] = [1, 8192, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 16, 256])
Average Execution Time: 10521.10 us
Peak Memory Usage: 640.75 MB
--------------------

--- Test Parameters: B=1, H=16, T=16384, D=64 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 16384, 64]
Input Shape (g): [B, T, H] = [1, 16384, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 16, 64])
Average Execution Time: 6747.74 us
Peak Memory Usage: 193.50 MB
--------------------

--- Test Parameters: B=1, H=16, T=16384, D=96 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 16384, 96]
Input Shape (g): [B, T, H] = [1, 16384, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 16, 96])
Average Execution Time: 10747.40 us
Peak Memory Usage: 289.50 MB
--------------------

--- Test Parameters: B=1, H=16, T=16384, D=128 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 16384, 128]
Input Shape (g): [B, T, H] = [1, 16384, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 16, 128])
Average Execution Time: 10879.97 us
Peak Memory Usage: 385.50 MB
--------------------

--- Test Parameters: B=1, H=16, T=16384, D=160 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 16384, 160]
Input Shape (g): [B, T, H] = [1, 16384, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 16, 160])
Average Execution Time: 39056.13 us
Peak Memory Usage: 801.50 MB
--------------------

--- Test Parameters: B=1, H=16, T=16384, D=192 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 16384, 192]
Input Shape (g): [B, T, H] = [1, 16384, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 16, 192])
Average Execution Time: 39317.04 us
Peak Memory Usage: 961.50 MB
--------------------

--- Test Parameters: B=1, H=16, T=16384, D=256 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 16384, 256]
Input Shape (g): [B, T, H] = [1, 16384, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 16, 256])
Average Execution Time: 40333.45 us
Peak Memory Usage: 1281.50 MB
--------------------

--- Test Parameters: B=1, H=16, T=32768, D=64 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 32768, 64]
Input Shape (g): [B, T, H] = [1, 32768, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 16, 64])
Average Execution Time: 25422.69 us
Peak Memory Usage: 387.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=32768, D=96 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 32768, 96]
Input Shape (g): [B, T, H] = [1, 32768, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 16, 96])
Average Execution Time: 41884.29 us
Peak Memory Usage: 579.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=32768, D=128 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 32768, 128]
Input Shape (g): [B, T, H] = [1, 32768, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 16, 128])
Average Execution Time: 41812.00 us
Peak Memory Usage: 771.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=32768, D=160 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 32768, 160]
Input Shape (g): [B, T, H] = [1, 32768, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 16, 160])
Average Execution Time: 156346.43 us
Peak Memory Usage: 1603.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=32768, D=192 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 32768, 192]
Input Shape (g): [B, T, H] = [1, 32768, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 16, 192])
Average Execution Time: 158333.80 us
Peak Memory Usage: 1923.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=32768, D=256 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 32768, 256]
Input Shape (g): [B, T, H] = [1, 32768, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 16, 256])
Average Execution Time: 163001.69 us
Peak Memory Usage: 2563.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=65536, D=64 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 65536, 64]
Input Shape (g): [B, T, H] = [1, 65536, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 16, 64])
Average Execution Time: 101755.95 us
Peak Memory Usage: 774.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=65536, D=96 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 65536, 96]
Input Shape (g): [B, T, H] = [1, 65536, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 16, 96])
Average Execution Time: 166194.46 us
Peak Memory Usage: 1158.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=65536, D=128 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 65536, 128]
Input Shape (g): [B, T, H] = [1, 65536, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 16, 128])
Average Execution Time: 167684.97 us
Peak Memory Usage: 1542.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=65536, D=160 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 65536, 160]
Input Shape (g): [B, T, H] = [1, 65536, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 16, 160])
Average Execution Time: 643668.40 us
Peak Memory Usage: 3206.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=65536, D=192 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 65536, 192]
Input Shape (g): [B, T, H] = [1, 65536, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 16, 192])
Average Execution Time: 651727.47 us
Peak Memory Usage: 3846.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=65536, D=256 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 65536, 256]
Input Shape (g): [B, T, H] = [1, 65536, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 16, 256])
Average Execution Time: 669309.78 us
Peak Memory Usage: 5126.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=131072, D=64 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 131072, 64]
Input Shape (g): [B, T, H] = [1, 131072, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 16, 64])
Average Execution Time: 414521.17 us
Peak Memory Usage: 1548.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=131072, D=96 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 131072, 96]
Input Shape (g): [B, T, H] = [1, 131072, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 16, 96])
Average Execution Time: 671332.70 us
Peak Memory Usage: 2316.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=131072, D=128 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 131072, 128]
Input Shape (g): [B, T, H] = [1, 131072, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 16, 128])
Average Execution Time: 683292.90 us
Peak Memory Usage: 3084.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=131072, D=160 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 131072, 160]
Input Shape (g): [B, T, H] = [1, 131072, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 16, 160])
Average Execution Time: 2613491.04 us
Peak Memory Usage: 6412.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=131072, D=192 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 131072, 192]
Input Shape (g): [B, T, H] = [1, 131072, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 16, 192])
Average Execution Time: 2657910.94 us
Peak Memory Usage: 7692.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=131072, D=256 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 131072, 256]
Input Shape (g): [B, T, H] = [1, 131072, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 16, 256])
Average Execution Time: 2731784.97 us
Peak Memory Usage: 10252.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=4096, D=64 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 4096, 64]
Input Shape (g): [B, T, H] = [1, 4096, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 32, 64])
Average Execution Time: 1123.35 us
Peak Memory Usage: 96.75 MB
--------------------

--- Test Parameters: B=1, H=32, T=4096, D=96 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 4096, 96]
Input Shape (g): [B, T, H] = [1, 4096, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 32, 96])
Average Execution Time: 1608.27 us
Peak Memory Usage: 144.75 MB
--------------------

--- Test Parameters: B=1, H=32, T=4096, D=128 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 4096, 128]
Input Shape (g): [B, T, H] = [1, 4096, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 32, 128])
Average Execution Time: 1590.46 us
Peak Memory Usage: 192.75 MB
--------------------

--- Test Parameters: B=1, H=32, T=4096, D=160 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 4096, 160]
Input Shape (g): [B, T, H] = [1, 4096, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 32, 160])
Average Execution Time: 5447.41 us
Peak Memory Usage: 400.75 MB
--------------------

--- Test Parameters: B=1, H=32, T=4096, D=192 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 4096, 192]
Input Shape (g): [B, T, H] = [1, 4096, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 32, 192])
Average Execution Time: 5558.74 us
Peak Memory Usage: 480.75 MB
--------------------

--- Test Parameters: B=1, H=32, T=4096, D=256 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 4096, 256]
Input Shape (g): [B, T, H] = [1, 4096, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 32, 256])
Average Execution Time: 5748.02 us
Peak Memory Usage: 640.75 MB
--------------------

--- Test Parameters: B=1, H=32, T=8192, D=64 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 8192, 64]
Input Shape (g): [B, T, H] = [1, 8192, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 32, 64])
Average Execution Time: 3458.76 us
Peak Memory Usage: 193.50 MB
--------------------

--- Test Parameters: B=1, H=32, T=8192, D=96 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 8192, 96]
Input Shape (g): [B, T, H] = [1, 8192, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 32, 96])
Average Execution Time: 5540.81 us
Peak Memory Usage: 289.50 MB
--------------------

--- Test Parameters: B=1, H=32, T=8192, D=128 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 8192, 128]
Input Shape (g): [B, T, H] = [1, 8192, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 32, 128])
Average Execution Time: 5603.64 us
Peak Memory Usage: 385.50 MB
--------------------

--- Test Parameters: B=1, H=32, T=8192, D=160 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 8192, 160]
Input Shape (g): [B, T, H] = [1, 8192, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 32, 160])
Average Execution Time: 19909.11 us
Peak Memory Usage: 801.50 MB
--------------------

--- Test Parameters: B=1, H=32, T=8192, D=192 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 8192, 192]
Input Shape (g): [B, T, H] = [1, 8192, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 32, 192])
Average Execution Time: 20215.59 us
Peak Memory Usage: 961.50 MB
--------------------

--- Test Parameters: B=1, H=32, T=8192, D=256 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 8192, 256]
Input Shape (g): [B, T, H] = [1, 8192, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 32, 256])
Average Execution Time: 20890.22 us
Peak Memory Usage: 1281.50 MB
--------------------

--- Test Parameters: B=1, H=32, T=16384, D=64 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 16384, 64]
Input Shape (g): [B, T, H] = [1, 16384, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 32, 64])
Average Execution Time: 12941.45 us
Peak Memory Usage: 387.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=16384, D=96 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 16384, 96]
Input Shape (g): [B, T, H] = [1, 16384, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 32, 96])
Average Execution Time: 20780.08 us
Peak Memory Usage: 579.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=16384, D=128 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 16384, 128]
Input Shape (g): [B, T, H] = [1, 16384, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 32, 128])
Average Execution Time: 21012.44 us
Peak Memory Usage: 771.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=16384, D=160 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 16384, 160]
Input Shape (g): [B, T, H] = [1, 16384, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 32, 160])
Average Execution Time: 77348.70 us
Peak Memory Usage: 1603.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=16384, D=192 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 16384, 192]
Input Shape (g): [B, T, H] = [1, 16384, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 32, 192])
Average Execution Time: 78697.31 us
Peak Memory Usage: 1923.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=16384, D=256 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 16384, 256]
Input Shape (g): [B, T, H] = [1, 16384, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 32, 256])
Average Execution Time: 81635.97 us
Peak Memory Usage: 2563.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=32768, D=64 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 32768, 64]
Input Shape (g): [B, T, H] = [1, 32768, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 32, 64])
Average Execution Time: 50383.81 us
Peak Memory Usage: 774.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=32768, D=96 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 32768, 96]
Input Shape (g): [B, T, H] = [1, 32768, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 32, 96])
Average Execution Time: 83229.05 us
Peak Memory Usage: 1158.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=32768, D=128 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 32768, 128]
Input Shape (g): [B, T, H] = [1, 32768, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 32, 128])
Average Execution Time: 83193.96 us
Peak Memory Usage: 1542.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=32768, D=160 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 32768, 160]
Input Shape (g): [B, T, H] = [1, 32768, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 32, 160])
Average Execution Time: 314059.02 us
Peak Memory Usage: 3206.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=32768, D=192 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 32768, 192]
Input Shape (g): [B, T, H] = [1, 32768, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 32, 192])
Average Execution Time: 318620.97 us
Peak Memory Usage: 3846.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=32768, D=256 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 32768, 256]
Input Shape (g): [B, T, H] = [1, 32768, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 32, 256])
Average Execution Time: 328703.74 us
Peak Memory Usage: 5126.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=65536, D=64 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 65536, 64]
Input Shape (g): [B, T, H] = [1, 65536, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 32, 64])
Average Execution Time: 205300.35 us
Peak Memory Usage: 1548.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=65536, D=96 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 65536, 96]
Input Shape (g): [B, T, H] = [1, 65536, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 32, 96])
Average Execution Time: 333825.56 us
Peak Memory Usage: 2316.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=65536, D=128 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 65536, 128]
Input Shape (g): [B, T, H] = [1, 65536, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 32, 128])
Average Execution Time: 336481.92 us
Peak Memory Usage: 3084.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=65536, D=160 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 65536, 160]
Input Shape (g): [B, T, H] = [1, 65536, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 32, 160])
Average Execution Time: 1291551.14 us
Peak Memory Usage: 6412.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=65536, D=192 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 65536, 192]
Input Shape (g): [B, T, H] = [1, 65536, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 32, 192])
Average Execution Time: 1311779.33 us
Peak Memory Usage: 7692.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=65536, D=256 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 65536, 256]
Input Shape (g): [B, T, H] = [1, 65536, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 32, 256])
Average Execution Time: 1347421.41 us
Peak Memory Usage: 10252.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=131072, D=64 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 131072, 64]
Input Shape (g): [B, T, H] = [1, 131072, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 32, 64])
Average Execution Time: 834593.94 us
Peak Memory Usage: 3096.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=131072, D=96 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 131072, 96]
Input Shape (g): [B, T, H] = [1, 131072, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 32, 96])
Average Execution Time: 1349629.86 us
Peak Memory Usage: 4632.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=131072, D=128 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 131072, 128]
Input Shape (g): [B, T, H] = [1, 131072, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 32, 128])
Average Execution Time: 1373401.32 us
Peak Memory Usage: 6168.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=131072, D=160 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 131072, 160]
Input Shape (g): [B, T, H] = [1, 131072, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 32, 160])
Average Execution Time: 5237898.01 us
Peak Memory Usage: 12824.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=131072, D=192 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 131072, 192]
Input Shape (g): [B, T, H] = [1, 131072, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 32, 192])
Average Execution Time: 5326974.36 us
Peak Memory Usage: 15384.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=131072, D=256 ---
---- Configuration ----
Version to Test: parallel
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 131072, 256]
Input Shape (g): [B, T, H] = [1, 131072, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 32, 256])
Average Execution Time: 5413011.99 us
Peak Memory Usage: 20504.00 MB
--------------------
