Benchmark results for version: fused_chunk
Test run on: 2025年 08月 22日 星期五 15:21:22 CST
----------------------------------------------------

--- Test Parameters: B=1, H=2, T=4096, D=64 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 4096, 64]
Input Shape (g): [B, T, H] = [1, 4096, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 2, 64])
Average Execution Time: 519.57 us
Peak Memory Usage: 5.05 MB
--------------------

--- Test Parameters: B=1, H=2, T=4096, D=96 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 4096, 96]
Input Shape (g): [B, T, H] = [1, 4096, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 2, 96])
Average Execution Time: 386.82 us
Peak Memory Usage: 16.55 MB
--------------------

--- Test Parameters: B=1, H=2, T=4096, D=128 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 4096, 128]
Input Shape (g): [B, T, H] = [1, 4096, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 2, 128])
Average Execution Time: 646.14 us
Peak Memory Usage: 22.05 MB
--------------------

--- Test Parameters: B=1, H=2, T=4096, D=160 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 4096, 160]
Input Shape (g): [B, T, H] = [1, 4096, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 2, 160])
Average Execution Time: 401.22 us
Peak Memory Usage: 32.55 MB
--------------------

--- Test Parameters: B=1, H=2, T=4096, D=192 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 4096, 192]
Input Shape (g): [B, T, H] = [1, 4096, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 2, 192])
Average Execution Time: 502.74 us
Peak Memory Usage: 39.05 MB
--------------------

--- Test Parameters: B=1, H=2, T=4096, D=256 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 4096, 256]
Input Shape (g): [B, T, H] = [1, 4096, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 2, 256])
Average Execution Time: 700.56 us
Peak Memory Usage: 60.05 MB
--------------------

--- Test Parameters: B=1, H=2, T=8192, D=64 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 8192, 64]
Input Shape (g): [B, T, H] = [1, 8192, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 2, 64])
Average Execution Time: 724.65 us
Peak Memory Usage: 10.09 MB
--------------------

--- Test Parameters: B=1, H=2, T=8192, D=96 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 8192, 96]
Input Shape (g): [B, T, H] = [1, 8192, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 2, 96])
Average Execution Time: 762.04 us
Peak Memory Usage: 33.09 MB
--------------------

--- Test Parameters: B=1, H=2, T=8192, D=128 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 8192, 128]
Input Shape (g): [B, T, H] = [1, 8192, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 2, 128])
Average Execution Time: 768.05 us
Peak Memory Usage: 44.09 MB
--------------------

--- Test Parameters: B=1, H=2, T=8192, D=160 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 8192, 160]
Input Shape (g): [B, T, H] = [1, 8192, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 2, 160])
Average Execution Time: 804.45 us
Peak Memory Usage: 65.09 MB
--------------------

--- Test Parameters: B=1, H=2, T=8192, D=192 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 8192, 192]
Input Shape (g): [B, T, H] = [1, 8192, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 2, 192])
Average Execution Time: 945.15 us
Peak Memory Usage: 78.09 MB
--------------------

--- Test Parameters: B=1, H=2, T=8192, D=256 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 8192, 256]
Input Shape (g): [B, T, H] = [1, 8192, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 2, 256])
Average Execution Time: 858.83 us
Peak Memory Usage: 120.09 MB
--------------------

--- Test Parameters: B=1, H=2, T=16384, D=64 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 16384, 64]
Input Shape (g): [B, T, H] = [1, 16384, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 2, 64])
Average Execution Time: 1436.92 us
Peak Memory Usage: 20.19 MB
--------------------

--- Test Parameters: B=1, H=2, T=16384, D=96 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 16384, 96]
Input Shape (g): [B, T, H] = [1, 16384, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 2, 96])
Average Execution Time: 1544.99 us
Peak Memory Usage: 66.19 MB
--------------------

--- Test Parameters: B=1, H=2, T=16384, D=128 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 16384, 128]
Input Shape (g): [B, T, H] = [1, 16384, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 2, 128])
Average Execution Time: 1540.80 us
Peak Memory Usage: 88.19 MB
--------------------

--- Test Parameters: B=1, H=2, T=16384, D=160 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 16384, 160]
Input Shape (g): [B, T, H] = [1, 16384, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 2, 160])
Average Execution Time: 1631.14 us
Peak Memory Usage: 130.19 MB
--------------------

--- Test Parameters: B=1, H=2, T=16384, D=192 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 16384, 192]
Input Shape (g): [B, T, H] = [1, 16384, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 2, 192])
Average Execution Time: 1671.90 us
Peak Memory Usage: 156.19 MB
--------------------

--- Test Parameters: B=1, H=2, T=16384, D=256 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 16384, 256]
Input Shape (g): [B, T, H] = [1, 16384, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 2, 256])
Average Execution Time: 1693.73 us
Peak Memory Usage: 240.19 MB
--------------------

--- Test Parameters: B=1, H=2, T=32768, D=64 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 32768, 64]
Input Shape (g): [B, T, H] = [1, 32768, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 2, 64])
Average Execution Time: 2996.42 us
Peak Memory Usage: 40.38 MB
--------------------

--- Test Parameters: B=1, H=2, T=32768, D=96 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 32768, 96]
Input Shape (g): [B, T, H] = [1, 32768, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 2, 96])
Average Execution Time: 3126.14 us
Peak Memory Usage: 132.38 MB
--------------------

--- Test Parameters: B=1, H=2, T=32768, D=128 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 32768, 128]
Input Shape (g): [B, T, H] = [1, 32768, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 2, 128])
Average Execution Time: 3096.74 us
Peak Memory Usage: 176.38 MB
--------------------

--- Test Parameters: B=1, H=2, T=32768, D=160 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 32768, 160]
Input Shape (g): [B, T, H] = [1, 32768, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 2, 160])
Average Execution Time: 3253.67 us
Peak Memory Usage: 260.38 MB
--------------------

--- Test Parameters: B=1, H=2, T=32768, D=192 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 32768, 192]
Input Shape (g): [B, T, H] = [1, 32768, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 2, 192])
Average Execution Time: 3306.56 us
Peak Memory Usage: 312.38 MB
--------------------

--- Test Parameters: B=1, H=2, T=32768, D=256 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 32768, 256]
Input Shape (g): [B, T, H] = [1, 32768, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 2, 256])
Average Execution Time: 3409.78 us
Peak Memory Usage: 480.38 MB
--------------------

--- Test Parameters: B=1, H=2, T=65536, D=64 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 65536, 64]
Input Shape (g): [B, T, H] = [1, 65536, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 2, 64])
Average Execution Time: 6044.18 us
Peak Memory Usage: 80.75 MB
--------------------

--- Test Parameters: B=1, H=2, T=65536, D=96 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 65536, 96]
Input Shape (g): [B, T, H] = [1, 65536, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 2, 96])
Average Execution Time: 6264.22 us
Peak Memory Usage: 264.75 MB
--------------------

--- Test Parameters: B=1, H=2, T=65536, D=128 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 65536, 128]
Input Shape (g): [B, T, H] = [1, 65536, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 2, 128])
Average Execution Time: 6250.23 us
Peak Memory Usage: 352.75 MB
--------------------

--- Test Parameters: B=1, H=2, T=65536, D=160 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 65536, 160]
Input Shape (g): [B, T, H] = [1, 65536, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 2, 160])
Average Execution Time: 6493.94 us
Peak Memory Usage: 520.75 MB
--------------------

--- Test Parameters: B=1, H=2, T=65536, D=192 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 65536, 192]
Input Shape (g): [B, T, H] = [1, 65536, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 2, 192])
Average Execution Time: 6585.69 us
Peak Memory Usage: 624.75 MB
--------------------

--- Test Parameters: B=1, H=2, T=65536, D=256 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 65536, 256]
Input Shape (g): [B, T, H] = [1, 65536, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 2, 256])
Average Execution Time: 6760.17 us
Peak Memory Usage: 960.75 MB
--------------------

--- Test Parameters: B=1, H=2, T=131072, D=64 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 131072, 64]
Input Shape (g): [B, T, H] = [1, 131072, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 2, 64])
Average Execution Time: 12297.05 us
Peak Memory Usage: 161.50 MB
--------------------

--- Test Parameters: B=1, H=2, T=131072, D=96 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 131072, 96]
Input Shape (g): [B, T, H] = [1, 131072, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 2, 96])
Average Execution Time: 12545.37 us
Peak Memory Usage: 529.50 MB
--------------------

--- Test Parameters: B=1, H=2, T=131072, D=128 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 131072, 128]
Input Shape (g): [B, T, H] = [1, 131072, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 2, 128])
Average Execution Time: 12380.95 us
Peak Memory Usage: 705.50 MB
--------------------

--- Test Parameters: B=1, H=2, T=131072, D=160 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 131072, 160]
Input Shape (g): [B, T, H] = [1, 131072, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 2, 160])
Average Execution Time: 12988.00 us
Peak Memory Usage: 1041.50 MB
--------------------

--- Test Parameters: B=1, H=2, T=131072, D=192 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 131072, 192]
Input Shape (g): [B, T, H] = [1, 131072, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 2, 192])
Average Execution Time: 13174.82 us
Peak Memory Usage: 1249.50 MB
--------------------

--- Test Parameters: B=1, H=2, T=131072, D=256 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 2, 131072, 256]
Input Shape (g): [B, T, H] = [1, 131072, 2]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 2, 256])
Average Execution Time: 13420.00 us
Peak Memory Usage: 1921.50 MB
--------------------

--- Test Parameters: B=1, H=4, T=4096, D=64 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 4096, 64]
Input Shape (g): [B, T, H] = [1, 4096, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 4, 64])
Average Execution Time: 385.14 us
Peak Memory Usage: 10.09 MB
--------------------

--- Test Parameters: B=1, H=4, T=4096, D=96 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 4096, 96]
Input Shape (g): [B, T, H] = [1, 4096, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 4, 96])
Average Execution Time: 400.89 us
Peak Memory Usage: 33.09 MB
--------------------

--- Test Parameters: B=1, H=4, T=4096, D=128 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 4096, 128]
Input Shape (g): [B, T, H] = [1, 4096, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 4, 128])
Average Execution Time: 405.40 us
Peak Memory Usage: 44.09 MB
--------------------

--- Test Parameters: B=1, H=4, T=4096, D=160 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 4096, 160]
Input Shape (g): [B, T, H] = [1, 4096, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 4, 160])
Average Execution Time: 439.13 us
Peak Memory Usage: 65.09 MB
--------------------

--- Test Parameters: B=1, H=4, T=4096, D=192 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 4096, 192]
Input Shape (g): [B, T, H] = [1, 4096, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 4, 192])
Average Execution Time: 462.93 us
Peak Memory Usage: 78.09 MB
--------------------

--- Test Parameters: B=1, H=4, T=4096, D=256 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 4096, 256]
Input Shape (g): [B, T, H] = [1, 4096, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 4, 256])
Average Execution Time: 502.08 us
Peak Memory Usage: 120.09 MB
--------------------

--- Test Parameters: B=1, H=4, T=8192, D=64 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 8192, 64]
Input Shape (g): [B, T, H] = [1, 8192, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 4, 64])
Average Execution Time: 736.01 us
Peak Memory Usage: 20.19 MB
--------------------

--- Test Parameters: B=1, H=4, T=8192, D=96 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 8192, 96]
Input Shape (g): [B, T, H] = [1, 8192, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 4, 96])
Average Execution Time: 809.17 us
Peak Memory Usage: 66.19 MB
--------------------

--- Test Parameters: B=1, H=4, T=8192, D=128 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 8192, 128]
Input Shape (g): [B, T, H] = [1, 8192, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 4, 128])
Average Execution Time: 822.97 us
Peak Memory Usage: 88.19 MB
--------------------

--- Test Parameters: B=1, H=4, T=8192, D=160 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 8192, 160]
Input Shape (g): [B, T, H] = [1, 8192, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 4, 160])
Average Execution Time: 893.92 us
Peak Memory Usage: 130.19 MB
--------------------

--- Test Parameters: B=1, H=4, T=8192, D=192 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 8192, 192]
Input Shape (g): [B, T, H] = [1, 8192, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 4, 192])
Average Execution Time: 919.39 us
Peak Memory Usage: 156.19 MB
--------------------

--- Test Parameters: B=1, H=4, T=8192, D=256 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 8192, 256]
Input Shape (g): [B, T, H] = [1, 8192, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 4, 256])
Average Execution Time: 989.53 us
Peak Memory Usage: 240.19 MB
--------------------

--- Test Parameters: B=1, H=4, T=16384, D=64 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 16384, 64]
Input Shape (g): [B, T, H] = [1, 16384, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 4, 64])
Average Execution Time: 1464.11 us
Peak Memory Usage: 40.38 MB
--------------------

--- Test Parameters: B=1, H=4, T=16384, D=96 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 16384, 96]
Input Shape (g): [B, T, H] = [1, 16384, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 4, 96])
Average Execution Time: 1636.92 us
Peak Memory Usage: 132.38 MB
--------------------

--- Test Parameters: B=1, H=4, T=16384, D=128 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 16384, 128]
Input Shape (g): [B, T, H] = [1, 16384, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 4, 128])
Average Execution Time: 1642.79 us
Peak Memory Usage: 176.38 MB
--------------------

--- Test Parameters: B=1, H=4, T=16384, D=160 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 16384, 160]
Input Shape (g): [B, T, H] = [1, 16384, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 4, 160])
Average Execution Time: 1789.44 us
Peak Memory Usage: 260.38 MB
--------------------

--- Test Parameters: B=1, H=4, T=16384, D=192 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 16384, 192]
Input Shape (g): [B, T, H] = [1, 16384, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 4, 192])
Average Execution Time: 1903.46 us
Peak Memory Usage: 312.38 MB
--------------------

--- Test Parameters: B=1, H=4, T=16384, D=256 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 16384, 256]
Input Shape (g): [B, T, H] = [1, 16384, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 4, 256])
Average Execution Time: 1956.95 us
Peak Memory Usage: 480.38 MB
--------------------

--- Test Parameters: B=1, H=4, T=32768, D=64 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 32768, 64]
Input Shape (g): [B, T, H] = [1, 32768, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 4, 64])
Average Execution Time: 3037.94 us
Peak Memory Usage: 80.75 MB
--------------------

--- Test Parameters: B=1, H=4, T=32768, D=96 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 32768, 96]
Input Shape (g): [B, T, H] = [1, 32768, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 4, 96])
Average Execution Time: 3265.68 us
Peak Memory Usage: 264.75 MB
--------------------

--- Test Parameters: B=1, H=4, T=32768, D=128 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 32768, 128]
Input Shape (g): [B, T, H] = [1, 32768, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 4, 128])
Average Execution Time: 3298.61 us
Peak Memory Usage: 352.75 MB
--------------------

--- Test Parameters: B=1, H=4, T=32768, D=160 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 32768, 160]
Input Shape (g): [B, T, H] = [1, 32768, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 4, 160])
Average Execution Time: 3512.22 us
Peak Memory Usage: 520.75 MB
--------------------

--- Test Parameters: B=1, H=4, T=32768, D=192 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 32768, 192]
Input Shape (g): [B, T, H] = [1, 32768, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 4, 192])
Average Execution Time: 3685.08 us
Peak Memory Usage: 624.75 MB
--------------------

--- Test Parameters: B=1, H=4, T=32768, D=256 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 32768, 256]
Input Shape (g): [B, T, H] = [1, 32768, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 4, 256])
Average Execution Time: 3910.69 us
Peak Memory Usage: 960.75 MB
--------------------

--- Test Parameters: B=1, H=4, T=65536, D=64 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 65536, 64]
Input Shape (g): [B, T, H] = [1, 65536, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 4, 64])
Average Execution Time: 6271.11 us
Peak Memory Usage: 161.50 MB
--------------------

--- Test Parameters: B=1, H=4, T=65536, D=96 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 65536, 96]
Input Shape (g): [B, T, H] = [1, 65536, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 4, 96])
Average Execution Time: 6522.97 us
Peak Memory Usage: 529.50 MB
--------------------

--- Test Parameters: B=1, H=4, T=65536, D=128 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 65536, 128]
Input Shape (g): [B, T, H] = [1, 65536, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 4, 128])
Average Execution Time: 6561.17 us
Peak Memory Usage: 705.50 MB
--------------------

--- Test Parameters: B=1, H=4, T=65536, D=160 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 65536, 160]
Input Shape (g): [B, T, H] = [1, 65536, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 4, 160])
Average Execution Time: 7182.58 us
Peak Memory Usage: 1041.50 MB
--------------------

--- Test Parameters: B=1, H=4, T=65536, D=192 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 65536, 192]
Input Shape (g): [B, T, H] = [1, 65536, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 4, 192])
Average Execution Time: 7200.49 us
Peak Memory Usage: 1249.50 MB
--------------------

--- Test Parameters: B=1, H=4, T=65536, D=256 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 65536, 256]
Input Shape (g): [B, T, H] = [1, 65536, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 4, 256])
Average Execution Time: 7722.00 us
Peak Memory Usage: 1921.50 MB
--------------------

--- Test Parameters: B=1, H=4, T=131072, D=64 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 131072, 64]
Input Shape (g): [B, T, H] = [1, 131072, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 4, 64])
Average Execution Time: 12401.20 us
Peak Memory Usage: 323.00 MB
--------------------

--- Test Parameters: B=1, H=4, T=131072, D=96 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 131072, 96]
Input Shape (g): [B, T, H] = [1, 131072, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 4, 96])
Average Execution Time: 13043.96 us
Peak Memory Usage: 1059.00 MB
--------------------

--- Test Parameters: B=1, H=4, T=131072, D=128 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 131072, 128]
Input Shape (g): [B, T, H] = [1, 131072, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 4, 128])
Average Execution Time: 13098.70 us
Peak Memory Usage: 1411.00 MB
--------------------

--- Test Parameters: B=1, H=4, T=131072, D=160 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 131072, 160]
Input Shape (g): [B, T, H] = [1, 131072, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 4, 160])
Average Execution Time: 13967.45 us
Peak Memory Usage: 2083.00 MB
--------------------

--- Test Parameters: B=1, H=4, T=131072, D=192 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 131072, 192]
Input Shape (g): [B, T, H] = [1, 131072, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 4, 192])
Average Execution Time: 14411.48 us
Peak Memory Usage: 2499.00 MB
--------------------

--- Test Parameters: B=1, H=4, T=131072, D=256 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 4, 131072, 256]
Input Shape (g): [B, T, H] = [1, 131072, 4]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 4, 256])
Average Execution Time: 15421.51 us
Peak Memory Usage: 3843.00 MB
--------------------

--- Test Parameters: B=1, H=8, T=4096, D=64 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 4096, 64]
Input Shape (g): [B, T, H] = [1, 4096, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 8, 64])
Average Execution Time: 370.06 us
Peak Memory Usage: 20.19 MB
--------------------

--- Test Parameters: B=1, H=8, T=4096, D=96 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 4096, 96]
Input Shape (g): [B, T, H] = [1, 4096, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 8, 96])
Average Execution Time: 442.42 us
Peak Memory Usage: 66.19 MB
--------------------

--- Test Parameters: B=1, H=8, T=4096, D=128 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 4096, 128]
Input Shape (g): [B, T, H] = [1, 4096, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 8, 128])
Average Execution Time: 462.89 us
Peak Memory Usage: 88.19 MB
--------------------

--- Test Parameters: B=1, H=8, T=4096, D=160 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 4096, 160]
Input Shape (g): [B, T, H] = [1, 4096, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 8, 160])
Average Execution Time: 527.71 us
Peak Memory Usage: 130.19 MB
--------------------

--- Test Parameters: B=1, H=8, T=4096, D=192 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 4096, 192]
Input Shape (g): [B, T, H] = [1, 4096, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 8, 192])
Average Execution Time: 551.93 us
Peak Memory Usage: 156.19 MB
--------------------

--- Test Parameters: B=1, H=8, T=4096, D=256 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 4096, 256]
Input Shape (g): [B, T, H] = [1, 4096, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 8, 256])
Average Execution Time: 751.25 us
Peak Memory Usage: 240.19 MB
--------------------

--- Test Parameters: B=1, H=8, T=8192, D=64 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 8192, 64]
Input Shape (g): [B, T, H] = [1, 8192, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 8, 64])
Average Execution Time: 743.46 us
Peak Memory Usage: 40.38 MB
--------------------

--- Test Parameters: B=1, H=8, T=8192, D=96 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 8192, 96]
Input Shape (g): [B, T, H] = [1, 8192, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 8, 96])
Average Execution Time: 891.75 us
Peak Memory Usage: 132.38 MB
--------------------

--- Test Parameters: B=1, H=8, T=8192, D=128 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 8192, 128]
Input Shape (g): [B, T, H] = [1, 8192, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 8, 128])
Average Execution Time: 921.90 us
Peak Memory Usage: 176.38 MB
--------------------

--- Test Parameters: B=1, H=8, T=8192, D=160 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 8192, 160]
Input Shape (g): [B, T, H] = [1, 8192, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 8, 160])
Average Execution Time: 1043.00 us
Peak Memory Usage: 260.38 MB
--------------------

--- Test Parameters: B=1, H=8, T=8192, D=192 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 8192, 192]
Input Shape (g): [B, T, H] = [1, 8192, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 8, 192])
Average Execution Time: 1086.68 us
Peak Memory Usage: 312.38 MB
--------------------

--- Test Parameters: B=1, H=8, T=8192, D=256 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 8192, 256]
Input Shape (g): [B, T, H] = [1, 8192, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 8, 256])
Average Execution Time: 1494.87 us
Peak Memory Usage: 480.38 MB
--------------------

--- Test Parameters: B=1, H=8, T=16384, D=64 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 16384, 64]
Input Shape (g): [B, T, H] = [1, 16384, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 8, 64])
Average Execution Time: 1567.32 us
Peak Memory Usage: 80.75 MB
--------------------

--- Test Parameters: B=1, H=8, T=16384, D=96 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 16384, 96]
Input Shape (g): [B, T, H] = [1, 16384, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 8, 96])
Average Execution Time: 1776.73 us
Peak Memory Usage: 264.75 MB
--------------------

--- Test Parameters: B=1, H=8, T=16384, D=128 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 16384, 128]
Input Shape (g): [B, T, H] = [1, 16384, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 8, 128])
Average Execution Time: 1832.47 us
Peak Memory Usage: 352.75 MB
--------------------

--- Test Parameters: B=1, H=8, T=16384, D=160 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 16384, 160]
Input Shape (g): [B, T, H] = [1, 16384, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 8, 160])
Average Execution Time: 2052.39 us
Peak Memory Usage: 520.75 MB
--------------------

--- Test Parameters: B=1, H=8, T=16384, D=192 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 16384, 192]
Input Shape (g): [B, T, H] = [1, 16384, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 8, 192])
Average Execution Time: 2150.84 us
Peak Memory Usage: 624.75 MB
--------------------

--- Test Parameters: B=1, H=8, T=16384, D=256 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 16384, 256]
Input Shape (g): [B, T, H] = [1, 16384, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 8, 256])
Average Execution Time: 2945.30 us
Peak Memory Usage: 960.75 MB
--------------------

--- Test Parameters: B=1, H=8, T=32768, D=64 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 32768, 64]
Input Shape (g): [B, T, H] = [1, 32768, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 8, 64])
Average Execution Time: 3137.36 us
Peak Memory Usage: 161.50 MB
--------------------

--- Test Parameters: B=1, H=8, T=32768, D=96 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 32768, 96]
Input Shape (g): [B, T, H] = [1, 32768, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 8, 96])
Average Execution Time: 3538.33 us
Peak Memory Usage: 529.50 MB
--------------------

--- Test Parameters: B=1, H=8, T=32768, D=128 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 32768, 128]
Input Shape (g): [B, T, H] = [1, 32768, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 8, 128])
Average Execution Time: 3645.95 us
Peak Memory Usage: 705.50 MB
--------------------

--- Test Parameters: B=1, H=8, T=32768, D=160 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 32768, 160]
Input Shape (g): [B, T, H] = [1, 32768, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 8, 160])
Average Execution Time: 4106.88 us
Peak Memory Usage: 1041.50 MB
--------------------

--- Test Parameters: B=1, H=8, T=32768, D=192 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 32768, 192]
Input Shape (g): [B, T, H] = [1, 32768, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 8, 192])
Average Execution Time: 4275.31 us
Peak Memory Usage: 1249.50 MB
--------------------

--- Test Parameters: B=1, H=8, T=32768, D=256 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 32768, 256]
Input Shape (g): [B, T, H] = [1, 32768, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 8, 256])
Average Execution Time: 5847.46 us
Peak Memory Usage: 1921.50 MB
--------------------

--- Test Parameters: B=1, H=8, T=65536, D=64 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 65536, 64]
Input Shape (g): [B, T, H] = [1, 65536, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 8, 64])
Average Execution Time: 6300.40 us
Peak Memory Usage: 323.00 MB
--------------------

--- Test Parameters: B=1, H=8, T=65536, D=96 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 65536, 96]
Input Shape (g): [B, T, H] = [1, 65536, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 8, 96])
Average Execution Time: 7068.84 us
Peak Memory Usage: 1059.00 MB
--------------------

--- Test Parameters: B=1, H=8, T=65536, D=128 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 65536, 128]
Input Shape (g): [B, T, H] = [1, 65536, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 8, 128])
Average Execution Time: 7268.86 us
Peak Memory Usage: 1411.00 MB
--------------------

--- Test Parameters: B=1, H=8, T=65536, D=160 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 65536, 160]
Input Shape (g): [B, T, H] = [1, 65536, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 8, 160])
Average Execution Time: 8142.37 us
Peak Memory Usage: 2083.00 MB
--------------------

--- Test Parameters: B=1, H=8, T=65536, D=192 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 65536, 192]
Input Shape (g): [B, T, H] = [1, 65536, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 8, 192])
Average Execution Time: 8538.80 us
Peak Memory Usage: 2499.00 MB
--------------------

--- Test Parameters: B=1, H=8, T=65536, D=256 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 65536, 256]
Input Shape (g): [B, T, H] = [1, 65536, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 8, 256])
Average Execution Time: 11576.45 us
Peak Memory Usage: 3843.00 MB
--------------------

--- Test Parameters: B=1, H=8, T=131072, D=64 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 131072, 64]
Input Shape (g): [B, T, H] = [1, 131072, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 8, 64])
Average Execution Time: 12833.09 us
Peak Memory Usage: 646.00 MB
--------------------

--- Test Parameters: B=1, H=8, T=131072, D=96 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 131072, 96]
Input Shape (g): [B, T, H] = [1, 131072, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 8, 96])
Average Execution Time: 14139.54 us
Peak Memory Usage: 2118.00 MB
--------------------

--- Test Parameters: B=1, H=8, T=131072, D=128 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 131072, 128]
Input Shape (g): [B, T, H] = [1, 131072, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 8, 128])
Average Execution Time: 14507.32 us
Peak Memory Usage: 2822.00 MB
--------------------

--- Test Parameters: B=1, H=8, T=131072, D=160 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 131072, 160]
Input Shape (g): [B, T, H] = [1, 131072, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 8, 160])
Average Execution Time: 16331.66 us
Peak Memory Usage: 4166.00 MB
--------------------

--- Test Parameters: B=1, H=8, T=131072, D=192 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 131072, 192]
Input Shape (g): [B, T, H] = [1, 131072, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 8, 192])
Average Execution Time: 18481.04 us
Peak Memory Usage: 4998.00 MB
--------------------

--- Test Parameters: B=1, H=8, T=131072, D=256 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 8, 131072, 256]
Input Shape (g): [B, T, H] = [1, 131072, 8]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 8, 256])
Average Execution Time: 24711.22 us
Peak Memory Usage: 7686.00 MB
--------------------

--- Test Parameters: B=1, H=12, T=4096, D=64 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 4096, 64]
Input Shape (g): [B, T, H] = [1, 4096, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 12, 64])
Average Execution Time: 371.97 us
Peak Memory Usage: 30.28 MB
--------------------

--- Test Parameters: B=1, H=12, T=4096, D=96 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 4096, 96]
Input Shape (g): [B, T, H] = [1, 4096, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 12, 96])
Average Execution Time: 477.98 us
Peak Memory Usage: 99.28 MB
--------------------

--- Test Parameters: B=1, H=12, T=4096, D=128 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 4096, 128]
Input Shape (g): [B, T, H] = [1, 4096, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 12, 128])
Average Execution Time: 518.18 us
Peak Memory Usage: 132.28 MB
--------------------

--- Test Parameters: B=1, H=12, T=4096, D=160 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 4096, 160]
Input Shape (g): [B, T, H] = [1, 4096, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 12, 160])
Average Execution Time: 674.21 us
Peak Memory Usage: 198.28 MB
--------------------

--- Test Parameters: B=1, H=12, T=4096, D=192 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 4096, 192]
Input Shape (g): [B, T, H] = [1, 4096, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 12, 192])
Average Execution Time: 636.44 us
Peak Memory Usage: 234.28 MB
--------------------

--- Test Parameters: B=1, H=12, T=4096, D=256 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 4096, 256]
Input Shape (g): [B, T, H] = [1, 4096, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 12, 256])
Average Execution Time: 864.20 us
Peak Memory Usage: 360.28 MB
--------------------

--- Test Parameters: B=1, H=12, T=8192, D=64 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 8192, 64]
Input Shape (g): [B, T, H] = [1, 8192, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 12, 64])
Average Execution Time: 780.26 us
Peak Memory Usage: 60.56 MB
--------------------

--- Test Parameters: B=1, H=12, T=8192, D=96 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 8192, 96]
Input Shape (g): [B, T, H] = [1, 8192, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 12, 96])
Average Execution Time: 949.02 us
Peak Memory Usage: 198.56 MB
--------------------

--- Test Parameters: B=1, H=12, T=8192, D=128 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 8192, 128]
Input Shape (g): [B, T, H] = [1, 8192, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 12, 128])
Average Execution Time: 1010.30 us
Peak Memory Usage: 264.56 MB
--------------------

--- Test Parameters: B=1, H=12, T=8192, D=160 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 8192, 160]
Input Shape (g): [B, T, H] = [1, 8192, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 12, 160])
Average Execution Time: 1166.72 us
Peak Memory Usage: 390.56 MB
--------------------

--- Test Parameters: B=1, H=12, T=8192, D=192 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 8192, 192]
Input Shape (g): [B, T, H] = [1, 8192, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 12, 192])
Average Execution Time: 1253.84 us
Peak Memory Usage: 468.56 MB
--------------------

--- Test Parameters: B=1, H=12, T=8192, D=256 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 8192, 256]
Input Shape (g): [B, T, H] = [1, 8192, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 12, 256])
Average Execution Time: 1702.41 us
Peak Memory Usage: 720.56 MB
--------------------

--- Test Parameters: B=1, H=12, T=16384, D=64 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 16384, 64]
Input Shape (g): [B, T, H] = [1, 16384, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 12, 64])
Average Execution Time: 1578.81 us
Peak Memory Usage: 121.12 MB
--------------------

--- Test Parameters: B=1, H=12, T=16384, D=96 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 16384, 96]
Input Shape (g): [B, T, H] = [1, 16384, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 12, 96])
Average Execution Time: 1871.14 us
Peak Memory Usage: 397.12 MB
--------------------

--- Test Parameters: B=1, H=12, T=16384, D=128 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 16384, 128]
Input Shape (g): [B, T, H] = [1, 16384, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 12, 128])
Average Execution Time: 2007.61 us
Peak Memory Usage: 529.12 MB
--------------------

--- Test Parameters: B=1, H=12, T=16384, D=160 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 16384, 160]
Input Shape (g): [B, T, H] = [1, 16384, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 12, 160])
Average Execution Time: 2308.40 us
Peak Memory Usage: 781.12 MB
--------------------

--- Test Parameters: B=1, H=12, T=16384, D=192 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 16384, 192]
Input Shape (g): [B, T, H] = [1, 16384, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 12, 192])
Average Execution Time: 2482.69 us
Peak Memory Usage: 937.12 MB
--------------------

--- Test Parameters: B=1, H=12, T=16384, D=256 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 16384, 256]
Input Shape (g): [B, T, H] = [1, 16384, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 12, 256])
Average Execution Time: 3352.09 us
Peak Memory Usage: 1441.12 MB
--------------------

--- Test Parameters: B=1, H=12, T=32768, D=64 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 32768, 64]
Input Shape (g): [B, T, H] = [1, 32768, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 12, 64])
Average Execution Time: 3162.58 us
Peak Memory Usage: 242.25 MB
--------------------

--- Test Parameters: B=1, H=12, T=32768, D=96 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 32768, 96]
Input Shape (g): [B, T, H] = [1, 32768, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 12, 96])
Average Execution Time: 3740.83 us
Peak Memory Usage: 794.25 MB
--------------------

--- Test Parameters: B=1, H=12, T=32768, D=128 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 32768, 128]
Input Shape (g): [B, T, H] = [1, 32768, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 12, 128])
Average Execution Time: 3988.34 us
Peak Memory Usage: 1058.25 MB
--------------------

--- Test Parameters: B=1, H=12, T=32768, D=160 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 32768, 160]
Input Shape (g): [B, T, H] = [1, 32768, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 12, 160])
Average Execution Time: 4620.20 us
Peak Memory Usage: 1562.25 MB
--------------------

--- Test Parameters: B=1, H=12, T=32768, D=192 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 32768, 192]
Input Shape (g): [B, T, H] = [1, 32768, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 12, 192])
Average Execution Time: 4950.25 us
Peak Memory Usage: 1874.25 MB
--------------------

--- Test Parameters: B=1, H=12, T=32768, D=256 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 32768, 256]
Input Shape (g): [B, T, H] = [1, 32768, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 12, 256])
Average Execution Time: 6641.87 us
Peak Memory Usage: 2882.25 MB
--------------------

--- Test Parameters: B=1, H=12, T=65536, D=64 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 65536, 64]
Input Shape (g): [B, T, H] = [1, 65536, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 12, 64])
Average Execution Time: 6344.25 us
Peak Memory Usage: 484.50 MB
--------------------

--- Test Parameters: B=1, H=12, T=65536, D=96 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 65536, 96]
Input Shape (g): [B, T, H] = [1, 65536, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 12, 96])
Average Execution Time: 7450.30 us
Peak Memory Usage: 1588.50 MB
--------------------

--- Test Parameters: B=1, H=12, T=65536, D=128 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 65536, 128]
Input Shape (g): [B, T, H] = [1, 65536, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 12, 128])
Average Execution Time: 7974.23 us
Peak Memory Usage: 2116.50 MB
--------------------

--- Test Parameters: B=1, H=12, T=65536, D=160 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 65536, 160]
Input Shape (g): [B, T, H] = [1, 65536, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 12, 160])
Average Execution Time: 9153.63 us
Peak Memory Usage: 3124.50 MB
--------------------

--- Test Parameters: B=1, H=12, T=65536, D=192 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 65536, 192]
Input Shape (g): [B, T, H] = [1, 65536, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 12, 192])
Average Execution Time: 9957.22 us
Peak Memory Usage: 3748.50 MB
--------------------

--- Test Parameters: B=1, H=12, T=65536, D=256 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 65536, 256]
Input Shape (g): [B, T, H] = [1, 65536, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 12, 256])
Average Execution Time: 14566.85 us
Peak Memory Usage: 5764.50 MB
--------------------

--- Test Parameters: B=1, H=12, T=131072, D=64 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 131072, 64]
Input Shape (g): [B, T, H] = [1, 131072, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 12, 64])
Average Execution Time: 12728.53 us
Peak Memory Usage: 969.00 MB
--------------------

--- Test Parameters: B=1, H=12, T=131072, D=96 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 131072, 96]
Input Shape (g): [B, T, H] = [1, 131072, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 12, 96])
Average Execution Time: 14929.12 us
Peak Memory Usage: 3177.00 MB
--------------------

--- Test Parameters: B=1, H=12, T=131072, D=128 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 131072, 128]
Input Shape (g): [B, T, H] = [1, 131072, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 12, 128])
Average Execution Time: 16010.73 us
Peak Memory Usage: 4233.00 MB
--------------------

--- Test Parameters: B=1, H=12, T=131072, D=160 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 131072, 160]
Input Shape (g): [B, T, H] = [1, 131072, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 12, 160])
Average Execution Time: 19817.71 us
Peak Memory Usage: 6249.00 MB
--------------------

--- Test Parameters: B=1, H=12, T=131072, D=192 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 131072, 192]
Input Shape (g): [B, T, H] = [1, 131072, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 12, 192])
Average Execution Time: 23415.77 us
Peak Memory Usage: 7497.00 MB
--------------------

--- Test Parameters: B=1, H=12, T=131072, D=256 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 12, 131072, 256]
Input Shape (g): [B, T, H] = [1, 131072, 12]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 12, 256])
Average Execution Time: 33888.30 us
Peak Memory Usage: 11529.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=4096, D=64 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 4096, 64]
Input Shape (g): [B, T, H] = [1, 4096, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 16, 64])
Average Execution Time: 386.38 us
Peak Memory Usage: 40.38 MB
--------------------

--- Test Parameters: B=1, H=16, T=4096, D=96 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 4096, 96]
Input Shape (g): [B, T, H] = [1, 4096, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 16, 96])
Average Execution Time: 519.58 us
Peak Memory Usage: 132.38 MB
--------------------

--- Test Parameters: B=1, H=16, T=4096, D=128 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 4096, 128]
Input Shape (g): [B, T, H] = [1, 4096, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 16, 128])
Average Execution Time: 565.02 us
Peak Memory Usage: 176.38 MB
--------------------

--- Test Parameters: B=1, H=16, T=4096, D=160 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 4096, 160]
Input Shape (g): [B, T, H] = [1, 4096, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 16, 160])
Average Execution Time: 772.94 us
Peak Memory Usage: 260.38 MB
--------------------

--- Test Parameters: B=1, H=16, T=4096, D=192 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 4096, 192]
Input Shape (g): [B, T, H] = [1, 4096, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 16, 192])
Average Execution Time: 810.84 us
Peak Memory Usage: 312.38 MB
--------------------

--- Test Parameters: B=1, H=16, T=4096, D=256 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 4096, 256]
Input Shape (g): [B, T, H] = [1, 4096, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 16, 256])
Average Execution Time: 1161.33 us
Peak Memory Usage: 480.38 MB
--------------------

--- Test Parameters: B=1, H=16, T=8192, D=64 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 8192, 64]
Input Shape (g): [B, T, H] = [1, 8192, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 16, 64])
Average Execution Time: 791.22 us
Peak Memory Usage: 80.75 MB
--------------------

--- Test Parameters: B=1, H=16, T=8192, D=96 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 8192, 96]
Input Shape (g): [B, T, H] = [1, 8192, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 16, 96])
Average Execution Time: 1024.69 us
Peak Memory Usage: 264.75 MB
--------------------

--- Test Parameters: B=1, H=16, T=8192, D=128 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 8192, 128]
Input Shape (g): [B, T, H] = [1, 8192, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 16, 128])
Average Execution Time: 1293.00 us
Peak Memory Usage: 352.75 MB
--------------------

--- Test Parameters: B=1, H=16, T=8192, D=160 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 8192, 160]
Input Shape (g): [B, T, H] = [1, 8192, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 16, 160])
Average Execution Time: 1505.62 us
Peak Memory Usage: 520.75 MB
--------------------

--- Test Parameters: B=1, H=16, T=8192, D=192 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 8192, 192]
Input Shape (g): [B, T, H] = [1, 8192, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 16, 192])
Average Execution Time: 1822.66 us
Peak Memory Usage: 624.75 MB
--------------------

--- Test Parameters: B=1, H=16, T=8192, D=256 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 8192, 256]
Input Shape (g): [B, T, H] = [1, 8192, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 16, 256])
Average Execution Time: 2315.97 us
Peak Memory Usage: 960.75 MB
--------------------

--- Test Parameters: B=1, H=16, T=16384, D=64 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 16384, 64]
Input Shape (g): [B, T, H] = [1, 16384, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 16, 64])
Average Execution Time: 1663.63 us
Peak Memory Usage: 161.50 MB
--------------------

--- Test Parameters: B=1, H=16, T=16384, D=96 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 16384, 96]
Input Shape (g): [B, T, H] = [1, 16384, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 16, 96])
Average Execution Time: 2033.52 us
Peak Memory Usage: 529.50 MB
--------------------

--- Test Parameters: B=1, H=16, T=16384, D=128 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 16384, 128]
Input Shape (g): [B, T, H] = [1, 16384, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 16, 128])
Average Execution Time: 2177.19 us
Peak Memory Usage: 705.50 MB
--------------------

--- Test Parameters: B=1, H=16, T=16384, D=160 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 16384, 160]
Input Shape (g): [B, T, H] = [1, 16384, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 16, 160])
Average Execution Time: 3112.07 us
Peak Memory Usage: 1041.50 MB
--------------------

--- Test Parameters: B=1, H=16, T=16384, D=192 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 16384, 192]
Input Shape (g): [B, T, H] = [1, 16384, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 16, 192])
Average Execution Time: 3368.36 us
Peak Memory Usage: 1249.50 MB
--------------------

--- Test Parameters: B=1, H=16, T=16384, D=256 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 16384, 256]
Input Shape (g): [B, T, H] = [1, 16384, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 16, 256])
Average Execution Time: 4705.48 us
Peak Memory Usage: 1921.50 MB
--------------------

--- Test Parameters: B=1, H=16, T=32768, D=64 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 32768, 64]
Input Shape (g): [B, T, H] = [1, 32768, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 16, 64])
Average Execution Time: 3185.24 us
Peak Memory Usage: 323.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=32768, D=96 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 32768, 96]
Input Shape (g): [B, T, H] = [1, 32768, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 16, 96])
Average Execution Time: 4037.79 us
Peak Memory Usage: 1059.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=32768, D=128 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 32768, 128]
Input Shape (g): [B, T, H] = [1, 32768, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 16, 128])
Average Execution Time: 4533.48 us
Peak Memory Usage: 1411.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=32768, D=160 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 32768, 160]
Input Shape (g): [B, T, H] = [1, 32768, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 16, 160])
Average Execution Time: 5923.10 us
Peak Memory Usage: 2083.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=32768, D=192 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 32768, 192]
Input Shape (g): [B, T, H] = [1, 32768, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 16, 192])
Average Execution Time: 6193.06 us
Peak Memory Usage: 2499.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=32768, D=256 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 32768, 256]
Input Shape (g): [B, T, H] = [1, 32768, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 16, 256])
Average Execution Time: 9357.03 us
Peak Memory Usage: 3843.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=65536, D=64 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 65536, 64]
Input Shape (g): [B, T, H] = [1, 65536, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 16, 64])
Average Execution Time: 6376.55 us
Peak Memory Usage: 646.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=65536, D=96 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 65536, 96]
Input Shape (g): [B, T, H] = [1, 65536, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 16, 96])
Average Execution Time: 8073.01 us
Peak Memory Usage: 2118.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=65536, D=128 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 65536, 128]
Input Shape (g): [B, T, H] = [1, 65536, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 16, 128])
Average Execution Time: 8633.87 us
Peak Memory Usage: 2822.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=65536, D=160 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 65536, 160]
Input Shape (g): [B, T, H] = [1, 65536, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 16, 160])
Average Execution Time: 11805.03 us
Peak Memory Usage: 4166.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=65536, D=192 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 65536, 192]
Input Shape (g): [B, T, H] = [1, 65536, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 16, 192])
Average Execution Time: 13528.34 us
Peak Memory Usage: 4998.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=65536, D=256 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 65536, 256]
Input Shape (g): [B, T, H] = [1, 65536, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 16, 256])
Average Execution Time: 20503.66 us
Peak Memory Usage: 7686.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=131072, D=64 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 131072, 64]
Input Shape (g): [B, T, H] = [1, 131072, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 16, 64])
Average Execution Time: 12763.43 us
Peak Memory Usage: 1292.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=131072, D=96 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 131072, 96]
Input Shape (g): [B, T, H] = [1, 131072, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 16, 96])
Average Execution Time: 16218.31 us
Peak Memory Usage: 4236.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=131072, D=128 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 131072, 128]
Input Shape (g): [B, T, H] = [1, 131072, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 16, 128])
Average Execution Time: 17256.26 us
Peak Memory Usage: 5644.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=131072, D=160 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 131072, 160]
Input Shape (g): [B, T, H] = [1, 131072, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 16, 160])
Average Execution Time: 27707.05 us
Peak Memory Usage: 8332.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=131072, D=192 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 131072, 192]
Input Shape (g): [B, T, H] = [1, 131072, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 16, 192])
Average Execution Time: 29636.46 us
Peak Memory Usage: 9996.00 MB
--------------------

--- Test Parameters: B=1, H=16, T=131072, D=256 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 16, 131072, 256]
Input Shape (g): [B, T, H] = [1, 131072, 16]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 16, 256])
Average Execution Time: 47380.45 us
Peak Memory Usage: 15372.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=4096, D=64 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 4096, 64]
Input Shape (g): [B, T, H] = [1, 4096, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 32, 64])
Average Execution Time: 423.24 us
Peak Memory Usage: 80.75 MB
--------------------

--- Test Parameters: B=1, H=32, T=4096, D=96 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 4096, 96]
Input Shape (g): [B, T, H] = [1, 4096, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 32, 96])
Average Execution Time: 769.68 us
Peak Memory Usage: 264.75 MB
--------------------

--- Test Parameters: B=1, H=32, T=4096, D=128 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 4096, 128]
Input Shape (g): [B, T, H] = [1, 4096, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 32, 128])
Average Execution Time: 828.07 us
Peak Memory Usage: 352.75 MB
--------------------

--- Test Parameters: B=1, H=32, T=4096, D=160 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 4096, 160]
Input Shape (g): [B, T, H] = [1, 4096, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 32, 160])
Average Execution Time: 1169.73 us
Peak Memory Usage: 520.75 MB
--------------------

--- Test Parameters: B=1, H=32, T=4096, D=192 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 4096, 192]
Input Shape (g): [B, T, H] = [1, 4096, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 32, 192])
Average Execution Time: 1265.22 us
Peak Memory Usage: 624.75 MB
--------------------

--- Test Parameters: B=1, H=32, T=4096, D=256 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 4096, 256]
Input Shape (g): [B, T, H] = [1, 4096, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 4096, 32, 256])
Average Execution Time: 2362.48 us
Peak Memory Usage: 960.75 MB
--------------------

--- Test Parameters: B=1, H=32, T=8192, D=64 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 8192, 64]
Input Shape (g): [B, T, H] = [1, 8192, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 32, 64])
Average Execution Time: 843.55 us
Peak Memory Usage: 161.50 MB
--------------------

--- Test Parameters: B=1, H=32, T=8192, D=96 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 8192, 96]
Input Shape (g): [B, T, H] = [1, 8192, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 32, 96])
Average Execution Time: 1515.32 us
Peak Memory Usage: 529.50 MB
--------------------

--- Test Parameters: B=1, H=32, T=8192, D=128 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 8192, 128]
Input Shape (g): [B, T, H] = [1, 8192, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 32, 128])
Average Execution Time: 1644.62 us
Peak Memory Usage: 705.50 MB
--------------------

--- Test Parameters: B=1, H=32, T=8192, D=160 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 8192, 160]
Input Shape (g): [B, T, H] = [1, 8192, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 32, 160])
Average Execution Time: 2477.51 us
Peak Memory Usage: 1041.50 MB
--------------------

--- Test Parameters: B=1, H=32, T=8192, D=192 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 8192, 192]
Input Shape (g): [B, T, H] = [1, 8192, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 32, 192])
Average Execution Time: 2549.38 us
Peak Memory Usage: 1249.50 MB
--------------------

--- Test Parameters: B=1, H=32, T=8192, D=256 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 8192, 256]
Input Shape (g): [B, T, H] = [1, 8192, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 8192, 32, 256])
Average Execution Time: 4693.36 us
Peak Memory Usage: 1921.50 MB
--------------------

--- Test Parameters: B=1, H=32, T=16384, D=64 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 16384, 64]
Input Shape (g): [B, T, H] = [1, 16384, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 32, 64])
Average Execution Time: 1687.14 us
Peak Memory Usage: 323.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=16384, D=96 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 16384, 96]
Input Shape (g): [B, T, H] = [1, 16384, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 32, 96])
Average Execution Time: 3009.30 us
Peak Memory Usage: 1059.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=16384, D=128 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 16384, 128]
Input Shape (g): [B, T, H] = [1, 16384, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 32, 128])
Average Execution Time: 3258.16 us
Peak Memory Usage: 1411.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=16384, D=160 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 16384, 160]
Input Shape (g): [B, T, H] = [1, 16384, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 32, 160])
Average Execution Time: 4809.57 us
Peak Memory Usage: 2083.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=16384, D=192 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 16384, 192]
Input Shape (g): [B, T, H] = [1, 16384, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 32, 192])
Average Execution Time: 5161.07 us
Peak Memory Usage: 2499.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=16384, D=256 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 16384, 256]
Input Shape (g): [B, T, H] = [1, 16384, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 16384, 32, 256])
Average Execution Time: 9365.90 us
Peak Memory Usage: 3843.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=32768, D=64 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 32768, 64]
Input Shape (g): [B, T, H] = [1, 32768, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 32, 64])
Average Execution Time: 3376.90 us
Peak Memory Usage: 646.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=32768, D=96 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 32768, 96]
Input Shape (g): [B, T, H] = [1, 32768, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 32, 96])
Average Execution Time: 5965.91 us
Peak Memory Usage: 2118.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=32768, D=128 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 32768, 128]
Input Shape (g): [B, T, H] = [1, 32768, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 32, 128])
Average Execution Time: 6490.52 us
Peak Memory Usage: 2822.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=32768, D=160 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 32768, 160]
Input Shape (g): [B, T, H] = [1, 32768, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 32, 160])
Average Execution Time: 9940.44 us
Peak Memory Usage: 4166.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=32768, D=192 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 32768, 192]
Input Shape (g): [B, T, H] = [1, 32768, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 32, 192])
Average Execution Time: 11552.55 us
Peak Memory Usage: 4998.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=32768, D=256 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 32768, 256]
Input Shape (g): [B, T, H] = [1, 32768, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 32768, 32, 256])
Average Execution Time: 20330.78 us
Peak Memory Usage: 7686.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=65536, D=64 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 65536, 64]
Input Shape (g): [B, T, H] = [1, 65536, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 32, 64])
Average Execution Time: 6769.76 us
Peak Memory Usage: 1292.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=65536, D=96 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 65536, 96]
Input Shape (g): [B, T, H] = [1, 65536, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 32, 96])
Average Execution Time: 11905.74 us
Peak Memory Usage: 4236.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=65536, D=128 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 65536, 128]
Input Shape (g): [B, T, H] = [1, 65536, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 32, 128])
Average Execution Time: 13347.74 us
Peak Memory Usage: 5644.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=65536, D=160 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 65536, 160]
Input Shape (g): [B, T, H] = [1, 65536, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 32, 160])
Average Execution Time: 23735.23 us
Peak Memory Usage: 8332.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=65536, D=192 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 65536, 192]
Input Shape (g): [B, T, H] = [1, 65536, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 32, 192])
Average Execution Time: 25833.96 us
Peak Memory Usage: 9996.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=65536, D=256 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 65536, 256]
Input Shape (g): [B, T, H] = [1, 65536, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 65536, 32, 256])
Average Execution Time: 47025.09 us
Peak Memory Usage: 15372.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=131072, D=64 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 131072, 64]
Input Shape (g): [B, T, H] = [1, 131072, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 32, 64])
Average Execution Time: 13523.89 us
Peak Memory Usage: 2584.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=131072, D=96 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 131072, 96]
Input Shape (g): [B, T, H] = [1, 131072, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 32, 96])
Average Execution Time: 26111.74 us
Peak Memory Usage: 8472.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=131072, D=128 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 131072, 128]
Input Shape (g): [B, T, H] = [1, 131072, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 32, 128])
Average Execution Time: 28973.06 us
Peak Memory Usage: 11288.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=131072, D=160 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 131072, 160]
Input Shape (g): [B, T, H] = [1, 131072, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 32, 160])
Average Execution Time: 47816.54 us
Peak Memory Usage: 16664.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=131072, D=192 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 131072, 192]
Input Shape (g): [B, T, H] = [1, 131072, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 32, 192])
Average Execution Time: 52073.86 us
Peak Memory Usage: 19992.00 MB
--------------------

--- Test Parameters: B=1, H=32, T=131072, D=256 ---
---- Configuration ----
Version to Test: fused_chunk
Device: cuda
Data Type: torch.bfloat16
Input Shape (q, k, v): [B, H, T, D] = [1, 32, 131072, 256]
Input Shape (g): [B, T, H] = [1, 131072, 32]
Warm-up Runs: 10
Timed Runs: 50
--------------------

Starting warm-up...
Warm-up complete.

Starting timer for 50 runs...
Timing complete.

Measuring peak memory usage...
Memory measurement complete.

---- Benchmark Results ----
Output Shape: torch.Size([1, 131072, 32, 256])
Average Execution Time: 94176.36 us
Peak Memory Usage: 30744.00 MB
--------------------
